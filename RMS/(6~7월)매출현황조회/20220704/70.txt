<? /**********************************************
Author				: 엄태영
Create Date			: 2022.05.11
Comment				: 매출현황조회
-----------------------------------------------
Modify Author		:
Modify date			:
Comment				:
 ***********************************************/
$N_ChkLevelValue = 40;
@include_once $_SERVER['DOCUMENT_ROOT'] . '/include/inc.level.php';
@include_once $_SERVER['DOCUMENT_ROOT'] . '/report/cls/cls.sales70.php';
@include_once $_SERVER['DOCUMENT_ROOT'] . '/cls/cls.employee.php';
// 변수생성
    $dateList = $_GET['dateList'];
    $s_date                = $_GET['s_date'] ? $_GET['s_date'] : date("Y-m-01");
    $e_date                = $_GET['e_date'] ? $_GET['e_date'] : date("Y-m-d");

    $cal_kind            = $_GET['cal_kind'];
    $syear                = $_GET['syear'];
    $smonth                = $_GET['smonth'];
    $sday                = $_GET['sday'];
    $eyear                 = $_GET['eyear'];
    $emonth                = $_GET['emonth'];
    $eday                = $_GET['eday'];

    $syear                 = $syear ? $syear     : date('Y');
    $smonth                = $smonth ? $smonth    : date('m');
    $sday                 = $sday ? $sday         : "01";
    $eyear                 = $eyear ? $eyear     : date('Y');
    $emonth                = $emonth ? $emonth    : date('m');
    $eday                 = $eday ? $eday         : date('d') - 1;

    $s_date                = $_GET['s_date'];
    $e_date                = $_GET['e_date'];
    $week                = $_GET['week'];
    $weekdayyn            = $_GET['weekdayyn'];

    $division1            = $_GET['division1'];
    $division2            = $_GET['division2'];
    $em_nm                = $_GET['em_nm'];

    $ad_type              = $_GET['ad_type'];
    $m_nm             = $_GET['m_nm'];
    $cs_nm        = $_GET['cs_nm'];
    $cs_m_id          = $_GET['cs_m_id'];
    $cs_num         = $_GET['cs_num'];

    // 주의 첫날과 마지막날 계산 START
    $sdate = "$syear-$smonth-$sday";
    $edate = "$eyear-$emonth-$eday";
    // 검색이 일요일일 경우 -1 day
    $yoil = array("일", "월", "화", "수", "목", "금", "토");
    if ($yoil[date('w', strtotime($sdate))] === '일') {
        $sdate = date('Y-m-d', strtotime($sdate . '-1 days'));
    }
    if ($yoil[date('w', strtotime($edate))] === '일') {
        $edate = date('Y-m-d', strtotime($edate . '-1 days'));
    }

    if(!$_GET['dr_dr1_from']){
        // $_GET['dr_dr1_to'] = date("Y-m-d"); //오늘
        $_GET['dr_dr1_to'] = date("Y-m-d", strtotime("-1 Day")); // 어제
        $_GET['dr_dr1_from'] = date("Y-m-d", mktime(0, 0, 0, intval(date('m')), 1, intval(date('Y')) )); //이번달 1일
        
    }
    // $firstDay = date("Y-m-d", mktime(0, 0, 0, intval(date('m')), 1, intval(date('Y')) )); //이번달 1일
    // $Date1 = "pay_date BETWEEN '" . $firstDay . "' AND '" . $today . "'"; // 이번달 1일부터 오늘까지
    // // $timestamp = strtotime("-1 month");
    // // $timestamp2 = strtotime("-1 day");
    // $sdate = $firstDay;
    // $edate = $today;


// 권한 설정    
    if ($_SESSION['em_level'] == 40) {
        $division1        = $_SESSION['em_division1'];
        $division2        = $_SESSION['em_division2'];
        $em_nm            = $_SESSION['s_em_seq'];
        $em_nm_1        = $_GET['em_nm'];
    } else if ($_SESSION['em_level'] == 30) {
        $division1        = $_SESSION['em_division1'];
        $division2        = $_SESSION['em_division2'];
        $em_nm            = $_GET['em_nm'];
        $em_nm_1        = $_GET['em_nm'];
    } else if ($_SESSION['em_level'] == 20) {
        $division1        = $_SESSION['em_division1'];
        $division2        = $_GET['division2'];
        $em_nm            = $_GET['em_nm'];
        $em_nm_1        = $_GET['em_nm'];
    } else if ($_SESSION['em_level'] == 10) {
        $division1        = $_GET['division1'];
        $division2        = $_GET['division2'];
        $em_nm            = $_GET['em_nm'];
        $em_nm_1        = $_GET['em_nm'];
    }
// S_RETURNVAL 가져오기
    $clsEmp            = new clsEmp();
    $clsGoodType    = new clsGoodType();
    if($_GET['search_type']== 'date'){
        $S_RETURNVAL        = $clsGoodType->funcSelectContract_date(); //  report -> cls -> cls.sales.php
    }else if($_GET['search_type']== 'division'){
        $S_RETURNVAL        = $clsGoodType->funcSelectContract_date(); //  report -> cls -> cls.sales.php
        $S_RETURNVAL2       = $clsGoodType->funcSelectContract_division(); //  report -> cls -> cls.sales.php
        // echo '<pre>'; 
        // print_r($S_RETURNVAL2);
        //  echo '</pre>';
    
    }else if($_GET['search_type']== 'customer'){
        $S_RETURNVAL        = $clsGoodType->funcSelectContract_date(); //  report -> cls -> cls.sales.php
        $S_RETURNVAL3       = $clsGoodType->funcSelectContract_customer(); //  report -> cls -> cls.sales.php
        // echo '<pre>'; 
        // print_r($S_RETURNVAL3);
        //  echo '</pre>';
    }else{
        $S_RETURNVAL        = $clsGoodType->funcSelectContract_date(); //  report -> cls -> cls.sales.php
    }
    $chart_RETURNVAL    = $clsGoodType->funcGoogleChartData();
    $S_RETURNVAL_EMP = $clsEmp->funSelectEmpAll(1);                                                         //  report -> cls -> cls.employee.php

    // if($_GET['s_item']!=='1' && $_GET['s_string']==''){
    //     echo '<script>alert("광고주 정보를 입력해주세요");history.back();</script>';
    // }


    //  echo '<pre>'; 
    // // print_r($S_RETURNVAL);
    // // print_r($S_RETURNVAL2);
    // print_r($S_RETURNVAL3);
    // // print_r(($chart_RETURNVAL));
    // // // print_r($chart_RETURNVAL);
    //  echo '</pre>';






// GET넘어온 날짜 변수 가공
    $sdate_one = date("Y-m-d", strtotime($_GET["dr_dr1_from"]));
    $sdate_two = date("Y-m-d", strtotime($_GET["dr_dr1_to"]));
    if($_GET['cal_kind']=='y'){
        $start_date = $_GET['dr_dr1_from'][0].$_GET['dr_dr1_from'][1].$_GET['dr_dr1_from'][2].$_GET['dr_dr1_from'][3];
    }
    $start_date = $sdate_one . " ~ " . $sdate_two;
    if (!$_GET['dr_dr1_from']) {
        $today = date("Y-m-d");
        $day_7ago = date("Y-m-d", strtotime("-7 Day"));
        $sdate_one = $day_7ago;
        $sdate_two = $today;
        $start_date = $sdate_one . " ~ " . $sdate_two;
    }
    // if ($_GET['cal_kind'] == 'm') {
    //     echo $start_date;
    // }
    if ($_GET['dr_dr2_from']) {
        $edate_one = date("Y-m-d", strtotime($_GET["dr_dr2_from"])); 
        $edate_two = date("Y-m-d", strtotime($_GET["dr_r2_to"])); 
        $end_date = $edate_one . " ~ " . $edate_two;
    }


// 광고유형, 광고매체, 광고상품 목록 관련
    $array_adtype           = @funSelectCom6('27');
    $array_producttype       = @funSelectCom6('28');
    $array_m_nmtype           = @funSelectCom6('29');

    if($_GET['check1']==1){
        $array_adtype = $array_adtype;
    }else if($_GET['check1']==2){
        $array_adtype = $array_m_nmtype;
    }

    //상품유형 키 밸류 번역해서 넣기
    foreach ($array_adtype as $k => $v) {
        if (in_array($k, $S_RETURNVAL['m_nm'])) {
            $array_nm_matching[$k] = $v;
            // $k 1230,1231.... $v검색유형 배너유형....
        }
    }

    if($_GET['search_type']=='customer'){
        foreach ($array_adtype as $k => $v) {
            if (in_array($k, $S_RETURNVAL3['m_nm3'])) {
                $array_m_nm_matching[$k] = $v;
                $array_m_nm[$k] = $v;

            }
        }
    }else{
        foreach ($array_adtype as $k => $v) {
            if (in_array($k, $S_RETURNVAL['m_nm'])) {
                $array_m_nm_matching[$k] = $v;
            }
        }
    }

    if($_GET['check1']==1){
        $array_nm_matching = $array_m_nm_matching;
    }else{
        $array_nm_matching = $array_m_nm_matching;
    } 

    if($_GET['check1']==2){
        $theadd           = @funSelectTheadCode2();
    }else{
        $theadd           = @funSelectTheadCode1();
    }
    // echo '<pre>';  
    // print_r($theadd);
    // echo '</pre>';  

    

// 최대값 최소값 구하기
    function chnageMaxMinTextColor($value, $max, $min){
        echo $value . " " . $max . " " . $min . "</br>";
    }
    /* 최대값 최소값 찾기 START */
    $maxDateValue = 0;
    $minDateValue = 9999999999;
    $maxDateValue2 = 0;
    $minDateValue2 = 9999999999;
    $maxDateValue3 = 0;
    $minDateValue3 = 9999999999;
    $maxValue = array();
    $minValue = array();
    $maxDateValue_wk = 0;
    $minDateValue_wk = 9999999999;
    $maxValue_wk = array();
    $minValue_wk = array();
// 주간 제외 나머지
    if ($cal_kind != "wk") {
        foreach ($S_RETURNVAL['good_type2'] as $k => $v) {
            foreach ($v as $k1 => $v1) {
                $maxValue[$k1] = 0; 
                $minValue[$k1] = 9999999999;

                $maxValue_wk[$k1] = 0;
                $minValue_wk[$k1] = 9999999999;
            }
            $good_type2_cnt[$k] = count($v);
        }
        foreach ($theadd as $k => $v) {
            foreach ($v as $k1 => $v1) {
                $maxValue_thead[$k1] = 0;
                $minValue_thead[$k1] = 9999999999;
            }
            $good_type2_cnt_thead[$k] = count($v);
            //echo count($v);
        }
        // print_r($good_type2_cnt_thead);

        foreach ($S_RETURNVAL['good_type2_price'] as $k => $v) {
            foreach ($v as $k1 => $v1) {
                foreach ($v1 as $k2 => $v2) {
                    $tt[$k] += $v2;
                    if ($v2 > $maxValue[$k2]) {
                        $maxValue[$k2] = $v2;
                    }
                    if ($v2 < $minValue[$k2]) {
                        $minValue[$k2] = $v2;
                    }
                }
            }
            if ($tt[$k] > $maxDateValue) {
                $maxDateValue = $tt[$k];
            }
            if ($tt[$k] < $minDateValue) {
                $minDateValue = $tt[$k];
            }
        }
        //  -----------------부문테이블--------------------
            foreach ($S_RETURNVAL2['good_type22'] as $k => $v) {
                foreach ($v as $k1 => $v1) {
                    $maxValue2[$k1] = 0;
                    $minValue2[$k1] = 9999999999;

                    $maxValue_wk[$k1] = 0;
                    $minValue_wk[$k1] = 9999999999;
                }
                $good_type2_cnt2[$k] = count($v);
            }
            foreach ($theadd as $k => $v) {
                foreach ($v as $k1 => $v1) {
                    $maxValue_thead[$k1] = 0;
                    $minValue_thead[$k1] = 9999999999;
                }
                $good_type2_cnt_thead2[$k] = count($v);
                //   echo count($v);
            }
            foreach ($S_RETURNVAL2['good_type2_price2'] as $k => $v) {
                foreach ($v as $k1 => $v1) {
                    foreach ($v1 as $k2 => $v2) {
                        $tt2[$k] += $v2;

                        if ($v2 > $maxValue2[$k2]) {
                            $maxValue2[$k2] = $v2;
                        }
                        if ($v2 < $minValue2[$k2]) {
                            $minValue2[$k2] = $v2;
                        }
                    }
                }
                if ($tt2[$k] > $maxDateValue2) {
                    $maxDateValue2 = $tt2[$k];
                }
                if ($tt2[$k] < $minDateValue2) {
                    $minDateValue2 = $tt2[$k];
                }
            }
        //  -----------------광고주테이블--------------------
        foreach ($S_RETURNVAL3['good_type23'] as $k => $v) {
            foreach ($v as $k1 => $v1) {
                $maxValue3[$k1] = 0;
                $minValue3[$k1] = 9999999999;

                $maxValue_wk3[$k1] = 0;
                $minValue_wk3[$k1] = 9999999999;
            }
            $good_type2_cnt3[$k] = count($v);
            
        }
        foreach ($theadd as $k => $v) {
            foreach ($v as $k1 => $v1) {
                $maxValue_thead[$k1] = 0;
                $minValue_thead[$k1] = 9999999999;
            }
            $good_type2_cnt_thead3[$k] = count($v);
            //  echo count($v);
        }
        foreach ($S_RETURNVAL3['good_type2_price3'] as $k => $v) {
            foreach ($v as $k1 => $v1) {
                foreach ($v1 as $k2 => $v2) {
                    $tt3[$k] += $v2;
                    if ($v2 > $maxValue3[$k2]) {
                        $maxValue3[$k2] = $v2;
                    }
                    if ($v2 < $minValue3[$k2]) {
                        $minValue3[$k2] = $v2;
                    }
                }
            }
            if ($tt3[$k] > $maxDateValue3) {
                $maxDateValue3 = $tt3[$k];
            }
            if ($tt3[$k] < $minDateValue3) {
                $minDateValue3 = $tt3[$k];
            }
            // echo '------------'.$tt3[$k];
        }
    



// 주간일때
    } else {
        foreach ($S_RETURNVAL['good_type2'] as $k => $v) {
            foreach ($v as $k1 => $v1) {
                $maxValue_wk[$k1] = 0;
                $minValue_wk[$k1] = 9999999999;
            }
            $good_type2_cnt[$k] = count($v);
        }
        foreach ($theadd as $k => $v) {
            foreach ($v as $k1 => $v1) {
                $maxValue_thead[$k1] = 0;
                $minValue_thead[$k1] = 9999999999;
            }
            $good_type2_cnt_thead[$k] = count($v);
            //  echo count($v);
        }
        foreach ($S_RETURNVAL['good_type2_price'] as $k => $v) {
            foreach ($v as $k1 => $v1) {
                foreach ($v1 as $k2 => $v2) {
                    $tt_wk[$k] += $v2;
                    if ($v2 > $maxValue_wk[$k2]) {
                        $maxValue_wk[$k2] = $v2;
                    }
                    if ($v2 < $minValue_wk[$k2]) {
                        $minValue_wk[$k2] = $v2;
                    }
                    // print_r($maxValue_wk);
                }
            }
            if ($tt_wk[$k] > $maxDateValue_wk) {
                $maxDateValue_wk = $tt_wk[$k];
                // echo $maxDateValue_wk;
            }
            if ($tt_wk[$k] < $minDateValue_wk) {
                $minDateValue_wk = $tt_wk[$k];
            }
        }


    // ---------------부문테이블--------------------------
        foreach ($S_RETURNVAL2['good_type22'] as $k => $v) {
            foreach ($v as $k1 => $v1) {
                $maxValue_wk2[$k1] = 0;
                $minValue_wk2[$k1] = 9999999999;
            }
            $good_type2_cnt2[$k] = count($v);
        }
        foreach ($theadd as $k => $v) {
            foreach ($v as $k1 => $v1) {
                $maxValue_thead[$k1] = 0;
                $minValue_thead[$k1] = 9999999999;
            }
            $good_type2_cnt_thead2[$k] = count($v);
            //   echo count($v);
        }
        foreach ($S_RETURNVAL2['good_type2_price2'] as $k => $v) {
            foreach ($v as $k1 => $v1) {
                foreach ($v1 as $k2 => $v2) {
                    $tt_wk2[$k] += $v2;
                    if ($v2 > $maxValue_wk2[$k2]) {
                        $maxValue_wk2[$k2] = $v2;
                    }
                    if ($v2 < $minValue_wk2[$k2]) {
                        $minValue_wk2[$k2] = $v2;
                    }
                }
            }
            if ($tt_wk2[$k] > $maxDateValue_wk2) {
                $maxDateValue_wk2 = $tt_wk2[$k];
            }
            if ($tt_wk2[$k] < $minDateValue_wk2) {
                $minDateValue_wk2 = $tt_wk2[$k];
            }
        }


    // ---------------광고주테이블--------------------------
        foreach ($S_RETURNVAL3['good_type23'] as $k => $v) {
            foreach ($v as $k1 => $v1) {
                $maxValue_wk3[$k1] = 0;
                $minValue_wk3[$k1] = 9999999999;
            }
            $good_type2_cnt3[$k] = count($v);
        }
        foreach ($S_RETURNVAL3['good_type2_price3'] as $k => $v) {
            foreach ($v as $k1 => $v1) {
                foreach ($v1 as $k2 => $v2) {
                    $tt_wk3[$k] += $v2;
                    if ($v2 > $maxValue_wk3[$k2]) {
                        $maxValue_wk3[$k2] = $v2;
                    }
                    if ($v2 < $minValue_wk3[$k2]) {
                        $minValue_wk3[$k2] = $v2;
                    }
                }
            }
            if ($tt_wk3[$k] > $maxDateValue_wk3) {
                $maxDateValue_wk3 = $tt_wk3[$k];
            }
            if ($tt_wk3[$k] < $minDateValue_wk3) {
                $minDateValue_wk3 = $tt_wk3[$k];
            }
        }
    }
    /* 최대값 최소값 찾기 END */?>
<title>매출관리리포트>매출현황조회</title>
<!-- iframe 관련 -->
    <script language='javascript'>
        function selectDivi1(division1, type) {
            iFrmSubmit.location.href = "/frame_division/select_division2.php?division1=" + division1 + "&type=" + type;
        }

        function selectDivi2(division1, division2, type) {
            iFrmSubmit.location.href = "/frame_division/select_division2.php?division1=" + division1 + "&division2=" + division2 + "&type=" + type;
        }

        function s_mode(lname) {
            if (lname == 'm' || lname == 'y') {
                document.all.spanStartDay.style.display = 'none';
                document.all.spanEndDay.style.display = 'none';
                document.all.divWeek.style.display = 'none';
                document.all.divWeekDayYn.style.display = 'none';
            } else if (lname == 'd') {
                document.all.spanStartDay.style.display = 'inline';
                document.all.spanEndDay.style.display = 'inline';
                document.all.divWeek.style.display = 'none';
                document.all.divWeekDayYn.style.display = 'none';
            } else if (lname == 'wk') {
                document.all.spanStartDay.style.display = 'inline';
                document.all.spanEndDay.style.display = 'none';
                document.all.divWeek.style.display = 'none';
                document.all.divWeekDayYn.style.display = 'none';
            } else if (lname == 'wd') {
                document.all.spanStartDay.style.display = 'inline';
                document.all.spanEndDay.style.display = 'inline';
                document.all.divWeek.style.display = 'inline';
                document.all.divWeekDayYn.style.display = 'inline';
            } else if (lname == 'w') {
                document.all.spanStartDay.style.display = 'inline';
                document.all.spanEndDay.style.display = 'inline';
                document.all.divWeek.style.display = 'none';
                document.all.divWeekDayYn.style.display = 'inline';
            }
        }

        // 광고유형, 광고매체 +, - 항목 처리
        $(function() {
            var productState = true;
            $("#titleProductType").on("click", function() {
                if ($("#btnProduct").text() == "-") {
                    $("#btnProduct").text("+");
                    $("#productType").attr("style", "display:none");
                } else {
                    $("#btnProduct").text("-");
                    $("#productType").attr("style", "display:inline");
                }
                if (productState) {
                    $("#productType").animate({
                        color: "#330000",
                    }, 0);
                    $('#productType').css('height', 'auto');
                } else {
                    $("#productType").animate({
                        color: "#000",
                        height: 00
                    }, 0);
                }
                productState = !productState;
            });
            var divState1 = true;
            $("#ad_type_td").on("click", function() {
                if ($("#btndiv1").html() == '<span class="ui-icon ui-icon-minusthick"></span>') {
                    $("#btndiv1").html('<span class="ui-icon ui-icon-plusthick"></span>');
                } else {
                    $("#btndiv1").html('<span class="ui-icon ui-icon-minusthick"></span>')
                }
                if (divState1) {
                    $("#divType1").animate({
                        color: "#fff",
                        height: 200
                    }, 0);
                    $('#divType1').css('height', 'auto');
                } else {
                    $("#divType1").animate({
                        color: "#000",
                        height: 20
                    }, 0);
                }
                divState1 = !divState1;
            });
            var divState2 = true;
            $("#m_nm_td").on("click", function() {
                console.log($("#btndiv2").html());
                if ($("#btndiv2").html() == '<span class="ui-icon ui-icon-minusthick"></span>') {
                    $("#btndiv2").html('<span class="ui-icon ui-icon-plusthick"></span>');

                } else {
                    $("#btndiv2").html('<span class="ui-icon ui-icon-minusthick"></span>');
                }
                if (divState2) {
                    $("#divType2").animate({
                        color: "#fff",
                        height: 200
                    }, 0);
                    $('#divType2').css('height', 'auto');
                } else {
                    $("#divType2").animate({
                        color: "#000",
                        height: 20
                    }, 0);
                }
                divState2 = !divState2;
            });
        });
    </script>

<!-- 계정리스트 팝업 함수 -->
    <script>
        function openWindowPop(url, name) {
            var options = 'top=10, left=10, width=1500, height=620, status=no, menubar=no, toolbar=no, resizable=no, location=no';
            window.open(url, name, options);
        }
    </script>

<!-- src link 목록 -->
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=css&amp;skin=doxy"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script type="text/javascript" src="/lib/datePicker/js/datepicker_copy.js"></script>
    <script type="text/javascript" src="/lib/datePicker/js/DateRange.js"></script>
    <script type="text/javascript" src="/lib/datePicker/js/DateRangesWidget.js"></script>
    <link rel="stylesheet" href="/lib/datePicker/css/datepicker/base.css" />
    <link rel="stylesheet" href="/lib/datePicker/css/DateRangesWidget/base.css" />
    
    

<!-- 로딩 실행 -->
    <script type="text/javascript">
        $(document).ready(function() {
            $('#loading').fadeOut(500);
        });
    </script>

<!-- 테이블 다운로드 관련 -->
    <script>
        var today = new Date();
        var year = today.getFullYear();
        var month = ('0' + (today.getMonth() + 1)).slice(-2);
        var day = ('0' + today.getDate()).slice(-2);
        var dateString = year + month + day;
        var filename = "매출현황조회" + dateString + "_default_data";


        function tableToExcel(id, title) {
            var data_type = 'data:application/vnd.ms-excel;charset=utf-8';
            // a 태그가 있어서 엑셀다운시 하이퍼링크가 생성되어서 컬러가 들어가지 않음. 때문에 a태그 자체를 아래와 같이 제거해줘야한다.
            var table_html = encodeURIComponent(document.getElementById(id).outerHTML.replace(/<(\/a|a)([^>]*)>/gi, ""));
            //console.log(document.getElementById(id).outerHTML.replace(/<(\/a|a)([^>]*)>/gi, ""))
            var a = document.createElement('a');
            a.href = data_type + ',%EF%BB%BF' + table_html;
            a.download = title + '.xls';
            a.click();
        }
    </script>


<!-- Style 추가 -->
    <style>
        label{
            display: inline-block;
            width: 80px;
            height: 20px;
        }
        table.dataTable thead th {
            text-align: center;
        }
        table.dataTable tfoot th,
        table.dataTable tfoot td {
            text-align: right;
        }
        table.dataTable tfoot th.center {
            text-align: center;
        }
        .dataTables_wrapper .dataTables_paginate {
            float: left;
            text-align: right;
            padding-top: 0.25em;
            position: sticky;
            left: 0;
        }
        .dataTables_wrapper .dataTables_paginate .paginate_button {
            box-sizing: border-box;
            display: inline-block;
            min-width: 1.5em;
            padding: 0.5em 1em;
            margin-left: 2px;
            text-align: center;
            text-decoration: none !important;
            cursor: pointer;
            color: #333 !important;
            border: 1px solid transparent;
            border-radius: 2px;
        }
        .dataTables_wrapper .dataTables_paginate .paginate_button.disabled, .dataTables_wrapper .dataTables_paginate .paginate_button.disabled:hover, .dataTables_wrapper .dataTables_paginate .paginate_button.disabled:active {
            cursor: default;
            color: #666 !important;
            border: 1px solid transparent;
            background: transparent;
            box-shadow: none;
        }
        .dataTables_wrapper .dataTables_paginate .paginate_button.current, .dataTables_wrapper .dataTables_paginate .paginate_button.current:hover {
            color: #333 !important;
            border: 1px solid rgba(0, 0, 0, 0.3);
            background-color: rgba(230, 230, 230, 0.1);
            background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, rgba(230, 230, 230, 0.1)), color-stop(100%, rgba(0, 0, 0, 0.1)));
            background: -webkit-linear-gradient(top, rgba(230, 230, 230, 0.1) 0%, rgba(0, 0, 0, 0.1) 100%);
            background: -moz-linear-gradient(top, rgba(230, 230, 230, 0.1) 0%, rgba(0, 0, 0, 0.1) 100%);
            background: -ms-linear-gradient(top, rgba(230, 230, 230, 0.1) 0%, rgba(0, 0, 0, 0.1) 100%);
            background: -o-linear-gradient(top, rgba(230, 230, 230, 0.1) 0%, rgba(0, 0, 0, 0.1) 100%);
            background: linear-gradient(to bottom, rgba(230, 230, 230, 0.1) 0%, rgba(0, 0, 0, 0.1) 100%);
        }

        #tablereport_date thead{
            position: sticky;
            top: 0;
            z-index: 99;
        }

        #tablereport_date tfoot{
            position: sticky;
            bottom: 0;
            z-index: 99;
        }
    
        #tablereport_date tbody tr td.center,
        .tablereport tfoot .center{
            position: sticky;
            left: 0;

        }

        #tablereport_date {
            width: 100%;
            text-align: center;
            border-spacing: 0px;
        }

        #tablereport_date th {
            border-top: 1px solid #cccccc;
            border-bottom: 1px solid #cccccc;
            border-right: 1px solid #cccccc;
        }
        #tablereport_date td {
            border-bottom: 1px solid #cccccc;
            border-right: 1px solid #cccccc;
        }
        .left104{
            position: sticky;
            left: 104;
        }
        .left184{
            position: sticky;
            left: 184;
        }
        /* .total_division{
            position: sticky;
            right: 137;
        } */
        /* #tablereport_date thead th {
            position: sticky;
            top: 0;
            white-space: nowrap; 
        } */
        .tablereport tbody tr td,
        .tablereport thead tr th,
        .tablereport tfoot tr th {
            border : none;
        }
        .tablereport {
            border-collapse: separate;
        }
        #tablereport_date tbody tr td.center, 
        #tablereport_date tfoot .center, 
        #tablereport_date thead .center {
            border-left: 1px solid #cccccc;
        }
        #tablereport_date > thead > tr:nth-child(1) > th:nth-child(1){
            border-left: 1px solid #cccccc;
        }
        [data-tooltip-text]:hover {
            position: relative;
        }
        [data-tooltip-text]:after {
            -webkit-transition: bottom .3s ease-in-out, opacity .3s ease-in-out;
            -moz-transition: bottom .3s ease-in-out, opacity .3s ease-in-out;
            transition: bottom .3s ease-in-out, opacity .3s ease-in-out;

            background-color: rgba(0, 0, 0, 0.8);

            -webkit-box-shadow: 0px 0px 3px 1px rgba(50, 50, 50, 0.4);
            -moz-box-shadow: 0px 0px 3px 1px rgba(50, 50, 50, 0.4);
            box-shadow: 0px 0px 3px 1px rgba(50, 50, 50, 0.4);
            
             -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            border-radius: 5px;
            
            color: #FFFFFF;
            font-size: 12px;
            margin-bottom: 10px;
            padding: 7px 12px;
            position: absolute;
            width: auto;
            min-width: 100px;
            max-width: 500px;
            word-wrap: break-word;

            z-index: 9999;

            opacity: 0;
            left: -9999px;
            top: 90%;
            
            content: attr(data-tooltip-text);
        }
        [data-tooltip-text]:hover:after {
            top: 130%;
            left: 0;
            opacity: 1;
        }
    </style>



<!-- 페이지 접속시 조회 auto클릭 -->
    <script>
            if(!<?=$_GET["dr_dr1_from"]?>){
                if('<?=$S_RETURNVAL?>' == ''){
                    setTimeout(function() {
                        var searchBtn = document.getElementById("searchBtn").click();
                    }, 200);
                }
                // console.log('if');
            }else if('<?=date("d", strtotime($_GET["dr_dr1_from"]))?>'=='01'){
                // console.log('else if');
                console.log('<?=date("d", strtotime($_GET["dr_dr1_from"]))?>');
            }else{
                if('<?=$S_RETURNVAL?>' == ''){
                    setTimeout(function() {
                        var searchBtn = document.getElementById("searchBtn").click();
                    }, 200);
                }
                // console.log('else');
            }
        </script>

<!-- left 사이즈 변수 -->
    <?
    if(!$_GET['dr_r2_to']){
        if($_GET['search_type']=='date'){
            $left_position = "left104";
        }
        if($_GET['search_type']=='division'){
            if($_GET['division1']==''){
                $left_position = "left104";
            }else{
                $left_position = "left184";
            }
        }
    }else{
        $left_position = "left184";
    }  
        ?>
<div style="float:left; width:100%"><br>
    <div style="float:left; height: 25px;display: flex; align-items: center; background-color: red;"></div>
    <?  //$title = '매출현황조회';
        //$pageIndex = '7';
        //@include_once $_SERVER['DOCUMENT_ROOT'] . '/tool/initBookMark.php'; ?>
    <!-- 조회영역 -->
    <div>
        <form method='GET' action='/report/sales/' name='frm1' onsubmit='return funcSubmit(this)'>
        <input type='hidden' name='nc' value='<?= $_GET['nc'] ?>'>
        <input type="hidden" name="em_seq1" value='<?=$_GET['em_seq1']?>'>
            <table width="100%" border="0" cellpadding="5" cellspacing="1" bgcolor="CCCCCC" align="left">
                <tr bgcolor="#FFFFFF">
                    <td bgcolor="#EFEFEF" id="ad_type_td" style="width: 180px">광고유형
                        <font id="btndiv1"><span class="ui-icon ui-icon-plusthick"></span></font>
                    </td>
                    <td valign="top">
                        <div id="divType1" class="ui-widget-content ui-corner-all" style="width:100%; height:20; overflow:auto; overflow-y:hidden; border:0px solid #FFF;">
                            <table cellpadding="0" cellspacing="0" border='0'>
                                <tr>
                                    <td width="100%" valign="top">
                                        <input type="radio" name="check1" id="ad_type" value="1" <?= $_GET['check1'] == '1' ? "checked" : "" ?> checked>유형별<br><br>
                                        <? foreach (funSelectCom6('27') as $key => $val) { ?>
                                            <input type="checkbox" value='<?= $key ?>' name="ad_type[]" id="ad_type" style="margin-left: 35px; border-radius: 100%;" <? foreach ($_GET['ad_type'] as $key1 => $val1) {
                                                                                                                                                                            echo $val1 == $key ? "checked" : "";
                                                                                                                                                                        } ?>/>
                                                    <label for="<?= $key ?>"><?= $val ?></label>
                                        <? } ?>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr bgcolor="#FFFFFF" style="cursor:pointer">
                    <td bgcolor="#EFEFEF" id="m_nm_td">광고매체
                        <font id="btndiv2"><span class="ui-icon ui-icon-plusthick"></font>
                    </td>
                  
                    <td valign="top">
                        <div id="divType2" class="ui-widget-content ui-corner-all" style="width:100%; height:20; overflow:auto; overflow-y:hidden; border:0px solid #FFF;">
                            <table cellpadding="0" cellspacing="0" border='0'>
                                <tr>
                                    <td width="100%" valign="top">
                                        <input type="radio" name="check1" id="m_nm" value="2" <?= $_GET['check1'] == '2' ? "checked" : "" ?>>매체별<br><br>
                                        <? $idx = 1; ?>
                                        <? foreach (funSelectCom6('29') as $key => $val) { ?>
                                            &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                                            <input type="checkbox" value='<?= $key ?>' name="m_nm[]" id="m_nm" style="border-radius: 100%;" <? foreach ($_GET['m_nm'] as $key1 => $val1) {
                                                echo $val1 == $key ? "checked" : "";
                                            } ?> />
                                            <label for="<?= $key ?>"><?= $val ?></label>
                                            
                                        <? $idx++;
                                            if ($idx % 12== 0) {
                                                echo '<br>';
                                            }
                                        } ?>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </td>
                </tr>
                <tr bgcolor="#FFFFFF" class="toggler">
                    <td bgcolor="#EFEFEF" height="auto">소속</td>
                    <td>
                        <select style="font-size:9pt" name='division1' class='adminSelect' onchange="selectDivi1(this.value,1); $('#em_selectBox').empty(); $('#em_selectBox').append('<option value=>직원선택</option>)') ";>
                            <option value=''>부문전체</option>
                            <? foreach (funSelectCom('1', '', '1', 'Y') as $key => $val) { ?>
                                <option value='<?= $key ?>' <?= $key == $division1 ? "selected" : "" ?>><?= $val ?></option>
                            <? } ?>
                        </select>
                        <span id="division2"></span>
                        <select name="division2" class='adminSelect' onchange="selectDivi2(frm1.division1.value,this.value,3); ">
                            <option value="">팀선택</option>
                        </select>
                        <select name="em_nm" class='adminSelect' id="em_selectBox">
                            <option value="">직원선택</option>
                        </select>
                    </td>
                </tr>
                <tr bgcolor="#FFFFFF">
                    <td bgcolor="#EFEFEF"> 광고주 </td>
                    <td>
                        <select id="searchSelect" name="s_item" style="width:100px">
                            <option value="1">선택</option>
                            <option value="cs_nm" <?= "cs_nm" == $_GET['s_item'] ? "selected" : "" ?>>광고주명</option>
                            <option value="cs_m_id" <?= "cs_m_id" == $_GET['s_item'] ? "selected" : "" ?>>광고계정</option>
                            <option value="cs_num" <?= "cs_num" == $_GET['s_item'] ? "selected" : "" ?>>사업자번호</option>
                        </select>
                        </select>
                        <input autocomplete="off" style="background-color: #F6F6F6" id="inputString" type="text" name="s_string" class='adminInputTxt' value="<?= $_GET['s_string'] ?>">
                    </td>
                </tr>
                <tr bgcolor="#FFFFFF">
                    <td bgcolor="#EFEFEF">조회유형 </td>
                    <td>
                        <input type="radio" value="d" name="cal_kind" checked onclick="s_mode('d')" <?= "d" == $cal_kind ? "checked" : "" ?>>일별
                        <input type="radio" value="wk" name="cal_kind" onclick="s_mode('wk')" <?= "wk" == $cal_kind ? "checked" : "" ?>>주별
                        <input type="radio" value="m" name="cal_kind" onclick="s_mode('m')" <?= "m" == $cal_kind ? "checked" : "" ?>>월별
                        <input type="radio" value="y" name="cal_kind" onclick="s_mode('y')" <?= "y" == $cal_kind ? "checked" : "" ?>>연별
                    </td>
                </tr>
                <tr bgcolor="#FFFFFF">
                    <td bgcolor="#EFEFEF">조회기간</td>
                    <td>
                        <div id="container" style="margin: 0; width: 200px;">
                            <div class="item" style="height: auto;">
                                <div class="pickerContainer widget" style="margin: 0">

                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr bgcolor="#FFFFFF">
                    <td colspan="2" align="center" height="30">
                        <button class="ui-button ui-widget ui-corner-all" type="submit" id="searchBtn"><span class="ui-button-icon ui-icon ui-icon-search"></span> 조 회</button>
                    </td>
                </tr>
            </table>
    </div>
    <div>&nbsp;</div>
    <!-- 차트 그려지는 영역 -->
    <div id="chart_div" style="width: 100%; height: 300px;"></div>
    <!-- 측정기준 영역 -->
    <div style="border-top: solid 1px #cccccc; border-bottom: solid 1px #cccccc; background-color: #EAEAEA; margin-top:10px; margin-bottom: 10px;" id="fileter_div1">
        &nbsp; 측정기준 &nbsp;:&nbsp;
        <select onChange="change(this.options[this.selectedIndex].value); console.log(this.options[this.selectedIndex].value);" name="search_type" id="search_type" style="width:120px; text-align: center; font-weight: bold; font-size: 12px;">
            <option value="date" <?= "date" == $_GET['search_type'] ? "selected" : "" ?>>기간</option>
            <option value="division" <?= "division" == $_GET['search_type'] ? "selected" : "" ?>>부문</option>
            <option value="customer" <?= "customer" == $_GET['search_type'] ? "selected" : "" ?>>광고주</option>
        </select>
        </form>
        <button id="excelBtn1" class="button" onclick="tableToExcel('tablereport_date',filename);" style="font-size: 14px; border: none; vertical-align: middle; display: inline;">
            <span class="ui-button-icon ui-icon ui-icon-arrowthickstop-1-s"></span> 다운로드
        </button>
    </div>
    <!-- 테이블 영역 시작 -->
    <div style="width: 100%; max-height: 490px; overflow: auto;">
        <table class="tablereport demo-1" id="tablereport_date" style="display: inline;">
            <thead>
            <?  if($_GET['search_type']){                    // 조회시 THEAD 영역?>      
                    <? if ($_GET["check1"]==1) {            // 광고유형별 조회시 THEAD 영역?>                  
                                        <tr>
                                            <th rowspan="2" align="center" style="left: 0; position: sticky; z-index: 9999;">
                                                    <? if (count($array_adtype) <= 3) { ?>
                                                        <div>
                                                    <? } else { 
                                                        if($_GET['search_type'] == 'date') {?>
                                                            <? if($_GET['cal_kind'] == 'wk' || $_GET['dr_dr2_from']) { ?>
                                                                <div align="center" style="width:180px">일자</div>
                                                            <? }else{ ?>
                                                                <div align="center" style="width:100px">일자</div>
                                                            <? } ?>
                                                        <? }if($_GET['search_type'] == 'division'){ ?>
                                                            <? if($_GET['dr_dr2_from']){ ?>
                                                                <div align="center" style="width:180px">부문</div>
                                                            <? }else{
                                                                if($_GET['division1']){ ?>
                                                                    <? if(!$_GET['division2']){ ?>
                                                                        <div align="center" style="width:180px">팀</div>
                                                                    <? }else{ ?>
                                                                        <div align="center" style="width:180px">담당자</div>
                                                                    <? } ?>
                                                            <?  }else{?>
                                                                    <div align="center" style="width:100px">부문</div>
                                                            <?}
                                                            } ?>
                                                        <? }else if($_GET['search_type'] == 'customer'){?>
                                                            <div align="center" style="width:180px">광고주</div>
                                                        <? }
                                                    }?>
                                            </th>
                                            <? if ($_GET['search_type']){?>
                                                <? if ($_GET['search_type'] !== 'division'){?>
                                                    <? if($_GET['cal_kind'] == 'wk' || $_GET['dr_dr2_from']) { ?>
                                                        <th rowspan="2" align="center" class="left184">합계</th>
                                                    <? }else{ ?>
                                                        <th rowspan="2" align="center" class="left104">합계</th>
                                                    <? } ?>
                                                <? }else{ ?>
                                                    <th rowspan="2" align="center" class="<?=$left_position?>">합계</th>
                                                <? } ?>
                                            <? } ?>
                                            <? if ($_GET['search_type'] == 'division'){?>
                                                <th rowspan="2" align="center" style="white-space: nowrap">&nbsp;&nbsp;전체 대비 비율(%) &nbsp;&nbsp;&nbsp;</th>
                                            <? } ?>
                                            <? foreach ($array_adtype as $k => $v) { ?>
                                                <th colspan="<?= $good_type2_cnt_thead[$k] ?>" align="center">
                                                    <?= $v ?> 
                                                </th>
                                            <? } ?>
                                        </tr>
                                        <tr>
                                            <? foreach ($array_adtype as $k => $v) {
                                                foreach ($theadd[$k] as $k1 => $v1) { ?>
                                                    <th style="width:50px;" ><?= funcGoodsKnm2($k1) ?></th>
                                            <? }
                                            } ?>
                                        </tr>
                    <?}else{                                // 광고매체별 조회시 THEAD 영역?>
                        <tr>
                        <th rowspan="2" align="center" style="left: 0; position: sticky; z-index: 9999;">
                                                    <? if (count($array_adtype) <= 3) { ?>
                                                        <div>
                                                    <? } else { 
                                                        if($_GET['search_type'] == 'date') {?>
                                                            <? if($_GET['cal_kind'] == 'wk' || $_GET['dr_dr2_from']) { ?>
                                                                <div align="center" style="width:180px">일자</div>
                                                            <? }else{ ?>
                                                                <div align="center" style="width:100px">일자</div>
                                                            <? } ?>
                                                        <? }if($_GET['search_type'] == 'division'){ ?>
                                                            <? if($_GET['dr_dr2_from']){ ?>
                                                                <div align="center" style="width:180px">부문</div>
                                                            <? }else{
                                                                if($_GET['division1']){ ?>
                                                                <div align="center" style="width:180px">부문</div>
                                                            <?  }else{?>
                                                                <div align="center" style="width:100px">부문</div>
                                                            <?}
                                                            } ?>
                                                        <? }else if($_GET['search_type'] == 'customer'){?>
                                                            <div align="center" style="width:180px">광고주</div>
                                                        <? }
                                                    }?>
                                            </th>
                                                <? if ($_GET['search_type']){?>
                                                    <? if ($_GET['search_type'] !== 'division'){?>
                                                        <? if($_GET['cal_kind'] == 'wk' || $_GET['dr_dr2_from']) { ?>
                                                            <th rowspan="2" align="center" class="left184">합계</th>
                                                        <? }else{ ?>
                                                            <th rowspan="2" align="center" class="left104">합계</th>
                                                        <? } ?>
                                                    <? }else{ ?>
                                                        <th rowspan="2" align="center" class="<?=$left_position?>">합계</th>
                                                    <? } ?>
                                                <? } ?>
                                                <? if ($_GET['search_type'] == 'division'){?>
                                                    <th rowspan="2" align="center" style="white-space: nowrap">&nbsp;&nbsp;전체 대비 비율(%) &nbsp;&nbsp;&nbsp;</th>
                                                <? } ?>

                                                <? foreach ($array_adtype as $k => $v) { ?>
                                                    <th colspan="<?= $good_type2_cnt_thead[$k] ?>" align="center" >
                                                    <?= $v ?> 
                                                    </th>
                                                <? } ?>
                                            </tr>
                                            <tr>
                                                <? foreach ($array_adtype as $k => $v) {
                                                    foreach ($theadd[$k] as $k1 => $v1) { ?>
                                                        <th style="width:50px;"><?= funcGoodsKnm2($k1) ?></th>
                                                <? }
                                                } ?>
                                            </tr>
                    <?} ?>
            <?  }else{                                    //Dafault THEAD영역 ?>
                    <tr>
                        <th rowspan="2" align="center" style="left: 0; position: sticky; z-index: 9999;">
                            <div align="center" style="width:50px;">일자</div>
                        </th>
                    <? $defaultCnt = 0; ?>
                        <? foreach ($array_adtype as $k => $v) { ?>
                            <th colspan="<?= $good_type2_cnt_thead[$k] ?>" align="center" >
                                <?= $v ?>   
                            </th>
                        <? } ?>

                        <? if ($_GET['search_type']){?>
                            <th rowspan="2" align="center" class="total">합계</th>
                        <? } ?>
                    </tr>
                    <tr>
                        <? foreach ($array_adtype as $k => $v) {
                            foreach ($theadd[$k] as $k1 => $v1) { ?>
                            <th style="width:50px"><?= funcGoodsKnm2($k1) ?></th>
                            <? $defaultCnt ++; ?>
                        <? }
                        } ?>
                    </tr>
                    </thead>
                    <tfoot>
                        <th style="left: 0; position: sticky; z-index: 9999;">합계</th>
                        <? for($i=0;$i<$defaultCnt;$i++){ ?>
                            <th>0</th>
                        <? } ?>
                    </tfoot>
                <?} ?>
                        </thead>
        <? // 일별 시작 ?>                
        <?if($cal_kind == "" || $cal_kind !== "wk" || $cal_kind == "wk" && $_GET['search_type']=='division' && $_GET['dr_r2_to']) { ?>
                <tbody>
                    <? $rate = array();
                    $rateIdx = 0;
                    if ($_GET['dr_dr2_from'] !== "") {
                        $rows[] = array('year', $start_date, $end_date);
                    } else {
                        $rows[] = array('year', $start_date);
                    }
                    if (!is_array($S_RETURNVAL['pay_date'])) {
                        array_push($rows, array(0, 0, 0));
                    }
            if ($_GET['search_type'] == 'date') {                                                    // 일별 기간
                                foreach ($S_RETURNVAL['pay_date'] as $k => $v) {
                                    list($d, $w) = explode(' ', date('Y-m-d w', strtotime($k)));
                                    $timestamp += 86400;
                                    if ($w % 6 == 0 || in_array($k, $GLOBALS['HOLIDAY'], true)) {
                                        $bgcolor = "#f3f3f3";
                                    } else {
                                        $bgcolor = "#FFFFFF";
                                    } ?>
                            <? foreach ($array_adtype as $k1 => $v1) {
                                foreach ($theadd[$k1] as $k2 => $v2) {
                                    $tot_date[$k]       += $S_RETURNVAL['good_type2_price'][$k][$k1][$k2];
                                }
                            }?>
                        <tr bgcolor="<?= $bgcolor ?>">

                            <td class='center' bgcolor="<?= $bgcolor ?>"><?= $_GET['cal_kind'] == "w" || $_GET['cal_kind'] == "wd" ? $k : $k ?></td>
                            
                            <td class='right total <?=$left_position?> b' bgcolor="<?= $bgcolor ?>">
                                <? if ($tot_date[$k] == $maxDateValue) {
                                    echo "<font color='#FF0000'><b>" . number_format($tot_date[$k]) . "</b></font>";
                                } else if ($tot_date[$k] == $minDateValue) {
                                    echo "<font color='#0080FF'><b>" . number_format($tot_date[$k]) . "</b></font>";
                                } else {
                                    echo number_format($tot_date[$k]);
                                }
                                ?>
                            </td>
                            <? foreach ($array_adtype as $k1 => $v1) {
                                        foreach ($theadd[$k1] as $k2 => $v2) {
                                            $realValue        = $S_RETURNVAL['good_type2_price'][$k][$k1][$k2];
                                            $tot[$k2]           += $S_RETURNVAL['good_type2_price'][$k][$k1][$k2];
                                            $tot_m_nm[$k1]      += $S_RETURNVAL['good_type2_price'][$k][$k1][$k2];
                                            // $tot_date[$k]       += $S_RETURNVAL['good_type2_price'][$k][$k1][$k2];
                                            $grand_tot          += $S_RETURNVAL['good_type2_price'][$k][$k1][$k2];
                                            $google_tot[$k]     += $S_RETURNVAL['good_type2_price'][$k][$k1][$k2];
                            ?>
                                    <td class='right'>
                                        <? if ($_GET['dr_r2_to']) {
                                                $new_k = str_replace('-', '', $k);
                                                $new_k = str_replace('~', '', $new_k);
                                                $new_k = str_replace(' ', '', $new_k);
                                                $new_k1 = substr($new_k, 0, 8);
                                                $new_k2 = substr($new_k, 8, 16);
                                                if ($realValue == $maxValue[$k2]) {
                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=date&cal_kind=" . $_GET['cal_kind'] . "&sdate=" . $new_k1 . "&edate=" . $new_k2 . "&code4=" . $k1 . "&good_type2=" . $k2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "&getDate1=".$_GET['dr_dr1_from']."&getDate2=".$_GET['dr_dr1_to']."&s_item=".$_GET['s_item']."&s_string=".$_GET['s_string']."','popup');><font color='#FF0000'><b>" . number_format($realValue) . "</b></font></a>";
                                                } else if ($realValue == $minValue[$k2]) {
                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=date&cal_kind=" . $_GET['cal_kind'] . "&sdate=" . $new_k1 . "&edate=" . $new_k2 . "&code4=" . $k1 . "&good_type2=" . $k2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "&getDate1=".$_GET['dr_dr1_from']."&getDate2=".$_GET['dr_dr1_to']."&s_item=".$_GET['s_item']."&s_string=".$_GET['s_string']."','popup');><font color='#0080FF'><b>" . number_format($realValue) . "</b></font></a>";
                                                } else {
                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=date&cal_kind=" . $_GET['cal_kind'] . "&sdate=" . $new_k1 . "&edate=" . $new_k2 . "&code4=" . $k1 . "&good_type2=" . $k2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "&getDate1=".$_GET['dr_dr1_from']."&getDate2=".$_GET['dr_dr1_to']."&s_item=".$_GET['s_item']."&s_string=".$_GET['s_string']."','popup');>" . number_format($realValue) . "</a>";
                                                }
                                                $rate[$rateIdx][] = $realValue != '' ? $realValue : 0;
                                            } else {
                                                if ($realValue == $maxValue[$k2]) {
                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=date&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $k . "&code4=" . $k1 . "&good_type2=" . $k2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "&getDate1=".$_GET['dr_dr1_from']."&getDate2=".$_GET['dr_dr1_to']."&s_item=".$_GET['s_item']."&s_string=".$_GET['s_string']."','popup');><font color='#FF0000'><b>" . number_format($realValue) . "</b></font></a>";
                                                } else if ($realValue == $minValue[$k2]) {
                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=date&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $k . "&code4=" . $k1 . "&good_type2=" . $k2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "&getDate1=".$_GET['dr_dr1_from']."&getDate2=".$_GET['dr_dr1_to']."&s_item=".$_GET['s_item']."&s_string=".$_GET['s_string']."','popup');><font color='#0080FF'><b>" . number_format($realValue) . "</b></font></a>";
                                                } else {
                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=date&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $k . "&code4=" . $k1 . "&good_type2=" . $k2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "&getDate1=".$_GET['dr_dr1_from']."&getDate2=".$_GET['dr_dr1_to']."&s_item=".$_GET['s_item']."&s_string=".$_GET['s_string']."','popup');>" . number_format($realValue) . "</a>";
                                                }
                                            } ?>
                                    </td>
                            <? }
                                    }
                                    $rateIdx++; ?>
                            
                        </tr>
                    <?
                                    if ($_GET['dr_dr2_from']) {

                                        array_push($rows, array($_GET['cal_kind'] == "w" || $_GET['cal_kind'] == "wd" ? $k : $k, $google_tot[$k], $tot_date[$k]));
                                    } else {
                                        array_push($rows, array($_GET['cal_kind'] == "w" || $_GET['cal_kind'] == "wd" ? $k : $k, $google_tot[$k]));
                                    }
                                }
                                $jsonTable1 = json_encode($rows); ?>
                </tbody>
                <? for ($i = 0; $i < count($rate[0]); $i++) {
                                        $rateTotal_one += $rate[1][$i];
                                        $rateTotal_two += $rate[0][$i];
                                    } ?>
                <tfoot>
                <? if ($_GET['dr_dr2_from']) {                                                          // 일별 기간 비교일자 ?>
                        <tr>
                            <th class='center'>증감액</th>

                            <th class='right total left184' rowspan="1" ><?= number_format($rateTotal_two - $rateTotal_one) ?></th>
                            <? for ($i = 0; $i < count($rate[0]); $i++) { ?>
                                <th class='right b'>
                                    <? if (count($tot) <= 13) { ?>
                                        <div>
                                        <? } else { ?>
                                            <div style="width:120px">
                                            <? } ?>
                                            <?= number_format($rate[0][$i] - $rate[1][$i]) ?></div>
                                </th>
                            <? } ?>
                        </tr>
                        <tr>
                            <th class='center'>증감율(%)</th>
                            <th class='right total left184' rowspan="1"><?= round(($rateTotal_two - $rateTotal_one) / $rateTotal_one * 100, 1) . '%' ?></th>
                            <? for ($i = 0; $i < count($rate[0]); $i++) { ?>
                                <th align="right"><?= round(($rate[1][$i] - $rate[0][$i]) / $rate[0][$i] * 100, 1) . '%' ?></th>
                            <? } ?>
                        </tr>
                    <? } else { ?>
                        <tr>
                            <th class='center' rowspan="2" style="left: 0; position: sticky; z-index: 9999; background-color: #E9E9E9;">합계</th>
                            <th class='right total <?=$left_position?>' rowspan="2"><?= number_format($grand_tot) ?></th>
                            <? foreach ($tot as $k => $v) { ?>
                                <th class='right b'>
                                    <? if (count($tot) <= 13) { ?>
                                        <div>
                                        <? } else { ?>
                                            <div style="width:120px">
                                            <? } ?>
                                            <?= number_format($v) ?></div>
                                </th>
                            <? } ?>
                            
                        </tr>
                        <tr>
                        <? foreach ($array_adtype as $k => $v) { ?>
                            <th colspan="<?= $good_type2_cnt_thead[$k] ?>" align="right"><?= number_format($tot_m_nm[$k]) ?></th>
                        <? }  ?>
                        </tr>
                    <? } ?>
                </tfoot>



            <? } else if ($_GET['search_type'] == 'division') {                                     // 일별 부문

                foreach ($S_RETURNVAL2['division1'] as $k => $v) {
                    foreach ($array_adtype as $k1 => $v1) {
                        foreach ($theadd[$k1] as $k2 => $v2) {
                            $grand_total        += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                        }
                    }
                }
                if(!$_GET['dr_dr2_from']){

                                foreach ($S_RETURNVAL2['division1'] as $k => $v) {  ?>
                                    <? foreach ($array_adtype as $k1 => $v1) {
                                        foreach ($theadd[$k1] as $k2 => $v2) {
                                            $tot_date2[$k]    += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                                        }
                                    }?>
                                    <tr bgcolor="#FFFFFF">
                                        <td class='center' bgcolor="#FFFFFF"><?= $_GET['cal_kind'] == "w" || $_GET['cal_kind'] == "wd" ? $k : $k ?></td>
                                        <td class='right total_division b <?=$left_position?>' style="background-color: white;">
                                            <? if ($tot_date2[$k] == $maxDateValue2) {
                                                            echo "<b>" . number_format($tot_date2[$k]) . "</b>";
                                                        } else if ($tot_date2[$k] == $minDateValue2) {
                                                            echo "<b>" . number_format($tot_date2[$k]) . "</b>";
                                                        } else {
                                                            echo number_format($tot_date2[$k]);
                                                        } ?>
                                        </td>
                                        <td class="total" style="background-color: white;">
                                            <? $percent = round($tot_date2[$k]/$grand_total*100,1); ?>
                                                <div class="progress-bar" style="float:left; width: 60%; height: 15px; background-color: #dedede; font-weight: 600; font-size: .8rem;">
                                                    <div class="progress" style="width: <?=$percent?>%; height: 15px; padding: 0; text-align: center;  background-color: #4F98FF; color: #111;">
                                                    </div>        
                                                </div>
                                                &nbsp;
                                                <div class="progress-bar" style="float:right; width: 30%; font-weight: 600; font-size: .8rem;">
                                                    <?=$percent.'%'?> 
                                                </div>
                                        </td>
                                                    <? foreach ($array_adtype as $k1 => $v1) {
                                                            foreach ($theadd[$k1] as $k2 => $v2) {
                                                                $realValue2        = $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                                                                $tot2[$k2]        += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                                                                $tot_m_nm2[$k1]    += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                                                                // $tot_date2[$k]    += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                                                                $grand_tot2        += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                                                                $google_tot2[$k]    += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2]; ?>
                                                <td class='right'>
                                                    <? if ($realValue2 == $maxValue2[$k2]) {
                                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=division&division_type=" . trim($v) . "&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $_GET['dr_dr1_from'] . "&sdate2=" . $_GET['dr_dr1_to'] . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "&s_item=".$_GET['s_item']."&s_string=".$_GET['s_string']."','popup');><font color='#FF0000'><b>" . number_format($realValue2) . "</b></font></a>";
                                                                } else if ($realValue2 == $minValue2[$k2]) {
                                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=division&division_type=" . trim($v) . "&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $_GET['dr_dr1_from'] . "&sdate2=" . $_GET['dr_dr1_to'] . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "&s_item=".$_GET['s_item']."&s_string=".$_GET['s_string']."','popup');><font color='#0080FF'><b>" . number_format($realValue2) . "</b></font></a>";
                                                                } else {
                                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=division&division_type=" . trim($v) . "&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $_GET['dr_dr1_from'] . "&sdate2=" . $_GET['dr_dr1_to'] . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "&s_item=".$_GET['s_item']."&s_string=".$_GET['s_string']."','popup');>" . number_format($realValue2) . "</a>";
                                                                } ?>
                                                </td>
                                                        <? }
                                                    } ?>
                                    </tr>
                                <? } ?>
                                </tbody>
                                <tfoot>
                                <tr>
                                    <th class='center' rowspan="2" style="left: 0; position: sticky; z-index: 9999; background-color: #E9E9E9;">합계</th>
                                    <th class='right total_division <?=$left_position?>' rowspan="2" style="border:1px solid #cccccc"><?= number_format($grand_tot2)//전체 합계 ?></th>
                                    <th class='right total' rowspan="2" style="text-align: center; vertical-align: middle;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<?= number_format($grand_tot2) ?>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                                    <? foreach ($tot2 as $k => $v) { ?>
                                        <th class='right b'>
                                            <? if (count($tot2) <= 13) { ?>
                                                <div>
                                                <? } else { ?>
                                                    <div style="width:120px">
                                                        <? } ?>
                                                        <?= number_format($v) ?></div>
                                                    </th>
                                                    <? } ?>
                                </tr>
                                <tr>
                                    <? foreach ($array_adtype as $k => $v) { ?>
                                        <th colspan="<?= $good_type2_cnt_thead2[$k] ?>" align="right">
                                            <?= number_format($tot_m_nm2[$k]) ?>
                                        </th>
                                    <? }?> 
                                </tr>
                                </tfoot>
                            <? 
                            $idxCnt = 1;
                }else{    
                        $total_temptemp_2 = array();                                                                           // 일별 부문별 비교일자
                        foreach ($S_RETURNVAL2['division1_kr_list'] as $ak => $av) {
                            foreach ($S_RETURNVAL2['price_compare'][$ak] as $k => $v) {
                                foreach ($array_adtype as $k1 => $v1) {
                                    foreach ($theadd[$k1] as $k2 => $v2) {
                                        $grand_total        += $S_RETURNVAL2['price_compare'][$ak][$k][$k1][$k2];
                                    }
                                }
                            }
                        }
                                foreach ($S_RETURNVAL2['division1_kr_list'] as $ak => $av) {
                                    foreach ($S_RETURNVAL2['pay_date'] as $k => $v) {  // A기간 B기간 데이터가 없어도 항상 보여지도록 pay_date로 설정?>
                                    <?   if($idxCnt % 2 == 0){ ?>
                                        <tr style="background-color: #f1f4fa;">
                                            <td class="center" style="background-color: #f1f4fa;"><?=$ak?></td>
                                            <?  $aka = 0;
                                                foreach ($array_adtype as $k1 => $v1) {
                                                    foreach ($theadd[$k1] as $k2 => $v2) { 
                                                        $aka++;?>
                                                    <? }
                                                }?>
                                                <? $aka = $aka+2; ?>
                                                <td colspan="<?=$aka?>"></td>    
                                        </tr> 
                                        <? $compareIdx = 0;     ?>
                                    <? } ?>
                                    <?  foreach ($array_adtype as $k1 => $v1) {
                                                            foreach ($theadd[$k1] as $k2 => $v2) {
                                                                $realValue2        = $S_RETURNVAL2['price_compare'][$ak][$k][$k1][$k2];
                                                                $tot2[$k2]        += $S_RETURNVAL2['price_compare'][$ak][$k][$k1][$k2];
                                                                $tot_m_nm2[$k1]    += $S_RETURNVAL2['price_compare'][$ak][$k][$k1][$k2];
                                                                $tot_date2[$k]    += $S_RETURNVAL2['price_compare'][$ak][$k][$k1][$k2];
                                                                $grand_tot2        += $S_RETURNVAL2['price_compare'][$ak][$k][$k1][$k2];
                                                                $google_tot2[$k]    += $S_RETURNVAL2['price_compare'][$ak][$k][$k1][$k2];
                                                                $compare[$ak][$compareIdx][] = $realValue2 != '' ? $realValue2 : 0; 
                                                                $total_temptemp_2[$ak][$compareIdx] += $realValue2 != '' ? $realValue2 : 0; 
                                                                }
                                                                }?>
                                    <tr bgcolor="#FFFFFF">
                                        <td class='center' style="background-color: #FFFFFF" bgcolor="#FFFFFF"><?= $_GET['cal_kind'] == "w" || $_GET['cal_kind'] == "wd" ? $k : $k ?></td>
                                        <td class='right b <?=$left_position?> ' style="background-color: white; ">
                                            <? if ($tot_date2[$k] == $maxDateValue2) {
                                                            echo "<b>" . number_format($tot_date2[$k]) . "</b>";
                                                        } else if ($tot_date2[$k] == $minDateValue2) {
                                                            echo "<b>" . number_format($tot_date2[$k]) . "</b>";
                                                        } else {
                                                            echo number_format($tot_date2[$k]);
                                                        } 
                                                        //$tot_date2[$k]      = 0;?>
                                        </td>

                                <td class="total" style="background-color: white;">
                                            <? 
                                            if($compareIdx==0){
                                                $percent = round($total_temptemp_2[$ak][0]/$S_RETURNVAL2['total_price1']*100,1);
                                            ?>
                                    <div class="progress-bar" style="float:left; width: 65%; height: 15px; background-color: #E9E9E9; font-weight: 600; font-size: .8rem;">
                                        <div class="progress" style="width: <?=$percent?>%; height: 15px; padding: 0; text-align: center;  background-color: #4F98FF; color: #111;">
                                        </div>        
                                    </div>
                                    <div class="progress-bar" style="float:right; width: 35%; font-weight: 600; font-size: .8rem;">
                                        <?=$percent.'%'?> 
                                    </div>
                                            <?
                                            }else if($compareIdx==1){
                                                $percent = round($total_temptemp_2[$ak][1]/$S_RETURNVAL2['total_price2']*100,1);
                                                ?>
                                    <div class="progress-bar" style="float:left; width: 65%; height: 15px; background-color: #E9E9E9; font-weight: 600; font-size: .8rem;">
                                        <div class="progress" style="width: <?=$percent?>%; height: 15px; padding: 0; text-align: center;  background-color: #4F98FF; color: #111;">
                                        </div>        
                                    </div>
                                    <div class="progress-bar" style="float:right; width: 35%; font-weight: 600; font-size: .8rem;">
                                        <?=$percent.'%'?> 
                                    </div>
                                                <?
                                            }
                                            ?>
                                    </td>
                                                    <?  foreach ($array_adtype as $k1 => $v1) {
                                                            foreach ($theadd[$k1] as $k2 => $v2) {
                                                                $realValue2        = $S_RETURNVAL2['price_compare'][$ak][$k][$k1][$k2]; ?>
                                                <td class='right'>
                                                <? 
                                                $new_k = str_replace('-', '', $k);
                                                $new_k = str_replace('~', '', $new_k);
                                                $new_k = str_replace(' ', '', $new_k);
                                                $new_k1 = substr($new_k, 0, 8);
                                                $new_k2 = substr($new_k, 8, 16);
                                                                if ($realValue2 == $maxValue2[$k2]) {
                                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=division&division_type=" . $ak . "&cal_kind=" . $_GET['cal_kind'] . "&sdate=" . $new_k1 . "&edate=" . $new_k2 . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "&s_item=".$_GET['s_item']."&s_string=".$_GET['s_string']."','popup');>" . number_format($realValue2) . "</a>";
                                                                } else if ($realValue2 == $minValue2[$k2]) {
                                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=division&division_type=" . $ak . "&cal_kind=" . $_GET['cal_kind'] . "&sdate=" . $new_k1 . "&edate=" . $new_k2 . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "&s_item=".$_GET['s_item']."&s_string=".$_GET['s_string']."','popup');>" . number_format($realValue2) . "</a>";
                                                                } else {
                                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=division&division_type=" . $ak . "&cal_kind=" . $_GET['cal_kind'] . "&sdate=" . $new_k1 . "&edate=" . $new_k2 . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "&s_item=".$_GET['s_item']."&s_string=".$_GET['s_string']."','popup');>" . number_format($realValue2) . "</a>";
                                                                }?>
                                                </td>
                                                            <? }
                                                        } ?>
                                        
                                        <? $tot_date2[$k]      = 0; 
                                        $compareIdx++;?>
                                </tr>
                                            
                        <?  if($idxCnt % 2 == 1){ 
                                    foreach($compare as $key => $value){
                                        for($i=0;$i<count($value[0]);$i++){
                                            $temp1[$key][] = $value[0][$i]-$value[1][$i];
                                            $temp2[$key][] = ($value[0][$i]-$value[1][$i])/$value[1][$i]*100;
                                        }
                                    } ?>          
                                            <? foreach ($temp1[$key] as $k => $v) { ?>
                                                        <? $total_ak[$ak] += $v ?>
                                            <? } ?>                      
                            <tr style="background-color: #EFEFEF">
                                <td class='center' style="background-color: #EFEFEF">증감액</td>
                                <td class='right b total_division left184' style="background-color: #EFEFEF;" rowspan="1">
                                    <?=  number_format($total_ak[$ak]) != '' ? number_format($total_ak[$ak]) : 0; ?>
                                </td>
                                <td class='right b total' rowspan="1" style="background-color: #EFEFEF; "></td>
                                <? foreach ($temp1[$key] as $k => $v) { ?>
                                    <td class='right b'>
                                        <? if (count($tot2) <= 13) { ?>
                                            <div>
                                            <? } else { ?>
                                                <div style="width:120px">
                                            <? } ?>
                                            <? echo number_format($v) != '' ? number_format($v) : 0; ?>
                                            <? //$total_ak[$ak] += $v ?>
                                                </div>
                                    </td>
                                <? } ?>
                            </tr>
                            <tr style="background-color: #EFEFEF">
                                <td class='center' style="background-color: #EFEFEF">증감율(%)</td>
                                <td class='right b total_division left184' style="background-color: #EFEFEF;" rowspan="1" ><?= round(($total_temptemp_2[$ak][0]-$total_temptemp_2[$ak][1])/$total_temptemp_2[$ak][1]*100,1) ?>%</td>
                                <td class='right b total' rowspan="1" style="background-color: #EFEFEF; "></td>
                                <? foreach ($temp2[$key] as $k => $v) { ?>
                                    <td class='right b' align="right" ><?=round($v,1);?>%</span></td>
                                <? } ?>
                            </tr>
                                    <? }$idxCnt++; 
                                    } 
                                } ?>                                                                
                                    </tbody>
                                    
                                <?
                            foreach($compare as $key => $value){
                                foreach($value as $k => $v){
                                    $colCnt = count($v); //col개수 31개
                                }
                            }
                                $justCnt = 0;
                                foreach($compare as $key => $value){
                                    for($i=0;$i<$colCnt;$i++){
                                        $sort_rate[$justCnt][] = $temp1[$key][$i];
                                        $sort_rate2[$justCnt][] = $temp2[$key][$i];
                                    }
                                    $justCnt++;
                                }
                            $sort_rate_Cnt =  count($sort_rate); // 항목의 개수 7
                            $justCnt2 = 0;
                            for($j=0; $j<$colCnt; $j++){
                                for($i=0; $i<$sort_rate_Cnt; $i++){
                                    $sort_total[$justCnt2][] =  $sort_rate[$i][$j];
                                    $sort_total2[$justCnt2][] =  $sort_rate2[$i][$j];
                                }
                                $justCnt2++;
                            }
                            for($i=0;$i<$colCnt;$i++){
                                for($j=0;$j<$sort_rate_Cnt;$j++){
                                    $sort_sum += $sort_total[$i][$j];
                                    $sort_sum2 += $sort_total2[$i][$j];
                                };
                                    $sort_total_sum[] = $sort_sum;
                                    $sort_total_sum2[] = $sort_sum2/$colCnt;
                                    $sort_sum =0;
                                    $sort_sum2 =0;
                            }
                            for($i=0;$i<$colCnt;$i++){
                                $rate_total_sum += $sort_total_sum[$i]; // 전체 증감액의 합계
                                $rate_total_sum2 += $sort_total_sum2[$i]; // 전체 증감액의 합계
                            }
                                ?>     
                            <?  foreach ($S_RETURNVAL2['division1_kr_list'] as $ak => $av) { 
                                $total_temp_sum1 += $total_temptemp_2[$ak][0];
                                $total_temp_sum2 += $total_temptemp_2[$ak][1];
                            } ?>
                    <!-- 전체 증감률은 일반 마케터의 경우 일반 증감률과 중복되기 때문에 필요가 없음 -->
                        <? if ($_SESSION['em_level'] == 10 || $_SESSION['em_level'] == 20) { ?>     
                        <tfoot>                               
                        <tr>
                    <th class='center'>전체 증감액</th>
                    <th class='right total_division left184' rowspan="1"><?= number_format($rate_total_sum) ?></th>
                    <th rowspan="2" class="total"> 
                    <?=number_format($total_temp_sum1)?>
                    대
                    <br>
                        <?=number_format($total_temp_sum2)?>
                    </th>

                    <? for ($i = 0; $i <$colCnt; $i++) { ?>
                        <th class='right b'>
                            <? if (count($colCnt) <= 13) { ?>
                                <div>
                                <? } else { ?>
                                    <div style="width:120px">
                                    <? } ?>
                                    <?= number_format($sort_total_sum[$i]) ?></div>
                        </th>
                    <? } ?>
                    </tr>
                    <tr>
                        <th class='center'>전체 증감율(%)</th>
                        <th class='right total_division left184' rowspan="1"><?= round(($total_temp_sum1-$total_temp_sum2)/$total_temp_sum2*100,1) . '%' ?></th>
                        <? for ($i = 0; $i < $colCnt; $i++) { ?>
                            <th align="right"><?= round($sort_total_sum2[$i],1) . '%' ?></th>
                        <? } ?>
                        
                    </tr>
                                
                        </tfoot>   
                        <? } ?>                                
                    <? }
            }else if ($_GET['search_type'] == 'customer') {                                         // 일별 광고주 
                if(!$_GET['dr_dr2_from']){
                        foreach ($S_RETURNVAL3['cs_seq'] as $k => $v) {   ?>
                                <?  foreach ($array_adtype as $k1 => $v1) {
                                        foreach ($S_RETURNVAL3['good_type23'][$k1] as $k2 => $v2) {
                                            $tot_date3[$k]      += $S_RETURNVAL3['good_type2_price3'][$k][$k1][$k2];
                                        }
                                    } ?>
                            <tr bgcolor="#FFFFFF">
                                <td class='center' bgcolor="#FFFFFF"><?= $_GET['cal_kind'] == "w" || $_GET['cal_kind'] == "wd" ? $k : $k ?></td>
                                <td class='right total b'><div style="width: 60px;">
                                <? if ($tot_date3[$k] == $maxDateValue3) {
                                    echo "<font color='#FF0000'>" . number_format($tot_date3[$k]) . "</font>";
                                } else if ($tot_date3[$k] == $minDateValue3) {
                                    echo "<font color='#0080FF'>" . number_format($tot_date3[$k]) . "</font>";
                                } else {
                                    echo number_format($tot_date3[$k]);
                                }
                                ?>
                                </div></td>
                                <?  foreach ($array_adtype as $k1 => $v1) {
                                        foreach ($theadd[$k1] as $k2 => $v2) {
                                            $realValue3         = $S_RETURNVAL3['good_type2_price3'][$k][$k1][$k2];
                                            $tot3[$k2]          += $S_RETURNVAL3['good_type2_price3'][$k][$k1][$k2];
                                            $tot_m_nm3[$k1]     += $S_RETURNVAL3['good_type2_price3'][$k][$k1][$k2];
                                            $grand_tot3         += $S_RETURNVAL3['good_type2_price3'][$k][$k1][$k2];
                                            $google_tot3[$k]    += $S_RETURNVAL3['good_type2_price3'][$k][$k1][$k2]; ?>
                                        <td class='right'>
                                            <? if ($realValue3 == $maxValue3[$k2]) {
                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=customer&cs_nm=" . $v . "&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $_GET['dr_dr1_from'] . "&sdate2=" . $_GET['dr_dr1_to'] . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "','popup');><font color='#FF0000'><b>" . number_format($realValue3) . "</b></font></a>";
                                                } else if ($realValue3 == $minValue3[$k2]) {
                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=customer&cs_nm=" . $v . "&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $_GET['dr_dr1_from'] . "&sdate2=" . $_GET['dr_dr1_to'] . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "','popup');><font color='#0080FF'><b>" . number_format($realValue3) . "</b></font></a>";
                                                } else {
                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=customer&cs_nm=" . $v . "&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $_GET['dr_dr1_from'] . "&sdate2=" . $_GET['dr_dr1_to'] . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "','popup');>" . number_format($realValue3) . "</a>";
                                                } ?>
                                        </td>
                                        <? }
                                } ?>
                            </tr>
                        <?  } ?>
                            </tbody>

                            <tfoot>
                                <? if ($_GET['dr_dr2_from']) { ?>
                                    <tr>
                                        <th class='center'>증감액</th>
                                    <? foreach ($tot3 as $k => $v) { ?>
                                            <th class='right b'>
                                                <? if (count($tot3) <= 13) { ?>
                                                    <div>
                                                <? } else { ?>
                                                    <div style="width:120px">
                                                <? } ?>
                                                    증감액합계1-<?= number_format($v) ?></div>
                                            </th>
                                        <? } ?>
                                            <th class='right' rowspan="1">증감액합계2-<?= number_format($grand_tot3) ?></th>
                                    </tr>
                                    <tr>
                                        <th>증감율(%)</th>
                                        <? foreach ($tot3 as $k => $v) { ?>
                                            <th align="right">증감율합계1-<?= number_format($tot3[$k]) ?></span></th>
                                        <? } ?>
                                        <th class='right' rowspan="1">증감율합계2-<?= number_format($grand_tot3) ?></th>
                                    </tr>
                                <? } else { ?>
                                    <tr>
                                        <th class='center' rowspan="2">합계</th>
                                        <th class='right' rowspan="2"><?= number_format($grand_tot3) ?></th>
                                        <? foreach ($tot3 as $k => $v) { ?>
                                            <th class='right b'>
                                                <? if (count($tot3) <= 13) { ?>
                                                    <div>
                                                    <? } else { ?>
                                                        <div style="width:120px">
                                                        <? } ?>
                                                        <?= number_format($v) ?></div>
                                            </th>
                                        <? } ?>
                                    </tr>
                                    <tr>
                                        <? foreach ($array_adtype as $k => $v) { ?>
                                            <th colspan="<?= $good_type2_cnt_thead3[$k] ?>" align="right"><?= number_format($tot_m_nm3[$k]) ?></span></th>
                                        <? } ?>
                                    </tr>
                            </tfoot>
                            <? }
            
                }else{                                                                                      // 일별 광고주 비교일자 
                            $total_temptemp3 = array();
                            foreach ($S_RETURNVAL3['cs_seq'] as $ak => $av) {
                                // colspan 구하기
                                    $aka = 0;
                                    foreach ($array_adtype as $k1 => $v1) {
                                        foreach ($theadd[$k1] as $k2 => $v2) { 
                                            $aka++;?>
                                        <? }
                                    }
                                    $aka = $aka+2;                                 
                                for($i=0;$i<$aka-2;$i++){
                                    $compare3[$ak][0][] = '0'; //비어있는 증감액 0으로 채우기
                                    $compare3[$ak][1][] = '0'; //비어있는 증감률 0으로 채우기
                                }


                                
                                foreach ($S_RETURNVAL3['pay_date'] as $k => $v) {   // A기간 B기간 데이터가 없어도 항상 보여지도록 pay_date로 설정
                                    if($idxCnt3 % 2 == 0){ // 광고주명 좌측에 넣어주기 ?>
                                        <tr style="background-color: #f1f4fa;">
                                            <td class="center"><?=$ak?></td>
                                            <td colspan="<?=$aka?>"></td>    
                                        </tr> 
                                    <? $compareIdx3 = 0;     
                                    } ?>
                                        <tr bgcolor="#FFFFFF">
                                        <td class='center' style="background-color: #FFFFFF"><?= $_GET['cal_kind'] == "w" || $_GET['cal_kind'] == "wd" ? $k : $k ?></td>
                                            <?foreach ($array_adtype as $k1 => $v1) {
                                                foreach ($theadd[$k1] as $k2 => $v2) {
                                                    $tot_date3[$k]      += $S_RETURNVAL3['price_compare3'][$ak][$k][$k1][$k2];
                                                }
                                            }
                                                    ?>                                            
                                            <td class='right b <?=$left_position?>' style="background-color: #FFFFFF;"><div style="width: 60px">
                                            <?= number_format($tot_date3[$k])?></div>
                                        </td>
                                            <?   $keyPlus = 0;
                                            foreach ($array_adtype as $k1 => $v1) {
                                                foreach ($theadd[$k1] as $k2 => $v2) {
                                                            $realValue3         =  $S_RETURNVAL3['price_compare3'][$ak][$k][$k1][$k2];
                                                            $tot3[$k2]          += $S_RETURNVAL3['price_compare3'][$ak][$k][$k1][$k2];
                                                            $tot_m_nm3[$k1]     += $S_RETURNVAL3['price_compare3'][$ak][$k][$k1][$k2];
                                                            $grand_tot3         += $S_RETURNVAL3['price_compare3'][$ak][$k][$k1][$k2];
                                                            $google_tot3[$k]    += $S_RETURNVAL3['price_compare3'][$ak][$k][$k1][$k2];  
                                                            $new_k = str_replace('-', '', $k);
                                                            $new_k = str_replace('~', '', $new_k);
                                                            $new_k = str_replace(' ', '', $new_k);
                                                            $new_k1 = substr($new_k, 0, 8);
                                                            $new_k2 = substr($new_k, 8, 16);?>
                                                            <td class='right'>
                                                                <div style="width: 120px">
                        <?="<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=customer&cs_nm=" . $S_RETURNVAL3['cs_seq'][$ak] . "&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $new_k1 . "&sdate2=" . $new_k2 . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "','popup');>" . number_format($realValue3) . "</a>"?>
                                                                </div>
                                                            </td>
                                                            <?  
                                                            $compare3[$ak][$compareIdx3][$keyPlus] = $realValue3 != '' ? $realValue3 : 0;
                                                            $total_temptemp3[$ak][$compareIdx3] += $realValue3 != '' ? $realValue3 : 0;
                                                            $keyPlus++;
                                                            ?>
                                                        <? }
                                                            } 
                                                    $tot_date3[$k] = 0;  // 합계 초기화 시키기 (누적합계 방지)
                                                    $compareIdx3++; // 광고주 CNT 증가?>
                                        </tr>
                                    <? if($idxCnt3 % 2 == 1){  // 광고주별 증감률 증감액 영역
                                        foreach($compare3 as $key => $value){
                                            for($i=0;$i<count($value[0]);$i++){
                                                // 증감액 배열 - key 광고주별로 
                                                $temp3_1[$key][] = $value[0][$i]-$value[1][$i] != '' ? $value[0][$i]-$value[1][$i] : 0;
                                                // 증감율 배열 - key 광고주별로 
                                                $temp3_2[$key][] = ($value[0][$i]-$value[1][$i])/$value[1][$i]*100 != '' ? ($value[0][$i]-$value[1][$i])/$value[1][$i]*100 : 0;
                                            }
                                        } ?>              
                                                <? foreach ($temp3_1[$key] as $k => $v) {
                                                        $total_temp3    += $v;
                                                        $total_ak[$ak]  += $v;
                                                    } ?>    
                                        <tr style="background-color: #EFEFEF">
                                            <td class='center' style="background-color: #EFEFEF">증감액</td>
                                            <td class='right b left184' rowspan="1" style="background-color: #EFEFEF">
                                                <?= number_format($total_ak[$ak]) != '' ? number_format($total_ak[$ak]) : 0 ?>
                                            </td>
                                                <? foreach ($temp3_1[$key] as $k => $v) { ?>
                                            <td class='right b' style="background-color: #EFEFEF"><?= number_format($v) != '' ? number_format($v) : 0 ?></td>
                                                <? } ?>                
                                        </tr>
                                        <tr style="background-color: #EFEFEF">
                                            <td class='center' style="background-color: #EFEFEF">증감율(%)</td>
                                            <td class='right left184 b' rowspan="1" style="background-color: #EFEFEF"><?= round(($total_temptemp3[$ak][0]-$total_temptemp3[$ak][1])/$total_temptemp3[$ak][1]*100,1) ?>%</td>
                                                <? foreach($temp3_2[$key] as $k => $v){?>
                                            <td class="right b"><?= round($v,1) != '' ? round($v,1) : 0 ?>%</td>
                                                <? }?>    
                                        </tr>
                                    <?  }$idxCnt3++; ?>
                              
                              <?  } 
                            } ?>
                            </tbody>
                        <?
                        foreach($compare3 as $key => $value){
                            foreach($value as $k => $v){
                                $colCnt3 = count($v); //col개수 31개
                            }
                        }
                        $justCnt3 = 0;
                        foreach($compare3 as $key => $value){
                            for($i=0;$i<$colCnt3; $i++){
                                $sort_rate_customer[$justCnt3][] = $temp3_1[$key][$i];
                                $sort_rate2_customer[$justCnt3][] = $temp3_2[$key][$i];
                            }
                            $justCnt3++;
                        }
                        $sort_rate_Cnt_customer =  count($sort_rate_customer); // 항목의 개수 7
                        $justCnt2_customer = 0;
                        for($j=0; $j<$colCnt3; $j++){
                            for($i=0; $i<$sort_rate_Cnt_customer; $i++){
                                $sort_total_customer[$justCnt2_customer][] =  $sort_rate_customer[$i][$j];
                                $sort_total2_customer[$justCnt2_customer][] =  $sort_rate2_customer[$i][$j];
                            }
                            $justCnt2_customer++;
                        }
                        for($i=0;$i<$colCnt3;$i++){
                            for($j=0;$j<$sort_rate_Cnt_customer;$j++){
                                $sort_sum_customer += $sort_total_customer[$i][$j];
                                $sort_sum2_customer += $sort_total2_customer[$i][$j];
                            };
                            $sort_total_sum_customer[] = $sort_sum_customer;
                            $sort_total_sum2_customer[] = $sort_sum2_customer/$colCnt3;
                            $sort_sum_customer =0;
                            $sort_sum2_customer =0;
                        }
                        for($i=0;$i<$colCnt3;$i++){
                            $rate_total_sum_customer += $sort_total_sum_customer[$i];
                            $rate_total_sum2_cusotmer += $sort_total_sum2_customer[$i]; 
                        }
                        foreach ($S_RETURNVAL3['cs_seq'] as $ak => $av) { 
                            $total_temp_sum1_customer += $total_temptemp3[$ak][0];
                            $total_temp_sum2_customer += $total_temptemp3[$ak][1];
                        }
                        // print_r($sort_total_sum2_customer);
                        ?>                            
                            <tfoot>
                            <tr>
                    <th class='center'>전체 증감액</th>
                    <th class='right total_division left184' rowspan="1"><?= number_format($rate_total_sum_customer) ?></th>
                    <? for ($i = 0; $i <$colCnt3; $i++) { ?>
                        <th class='right b'>
                            <? if (count($colCnt3) <= 13) { ?>
                                <div>
                                <? } else { ?>
                                    <div style="width:120px">
                                    <? } ?>
                                    <?= number_format($sort_total_sum_customer[$i]) ?></div>
                        </th>
                    <? } ?>
                    </tr>
                    <tr>
                        <th class='center'>전체 증감율(%)</th>
                        <th class='right total_division left184' rowspan="1"><?= round(($total_temp_sum1_customer-$total_temp_sum2_customer)/$total_temp_sum2_customer*100,1) . '%' ?></th>
                        <? for ($i = 0; $i < $colCnt3; $i++) { ?>
                            <th align="right"><?= round($sort_total_sum2_customer[$i],1) . '%' ?></th>
                        <? } ?>
                        
                    </tr>
                            </tfoot>
                    <?    }
                        
            }
        }//일별 끝
        //주별 시작
        if ($cal_kind == "wk") {  ?>                          
            <? if($_GET['search_type'] == 'date'){                                                  //기간별 주별 ?>       
                        <tbody>
                        <? 
                        $rate = array();
                        $rateIdx = 0;
                        $rows_wk[] = array('year', '합계');
                        if (!is_array($S_RETURNVAL['pay_date'])) {
                            array_push($rows_wk, array(0, 0));
                        }
                    
                        foreach ($S_RETURNVAL['pay_date'] as $k => $v) { ?>
                            <? foreach ($array_adtype as $k1 => $v1) {
                                foreach ($theadd[$k1] as $k2 => $v2) {
                                    $tot_date[$k]       += $S_RETURNVAL['good_type2_price'][$v][$k1][$k2];
                                }
                            }  ?>
                            <tr bgcolor="#FFFFFF">
                                <td class='center' bgcolor="#FFFFFF"><?= $v ?></td>
                                <td class='right total b left184' style="background-color: white; ">
                                    <? if ($tot_date[$k] == $maxDateValue_wk) {
                                                echo "<font color='#FF0000'><b>" . number_format($tot_date[$k]) . "</b></font>";
                                            } else if ($tot_date[$k] == $minDateValue_wk) {
                                                echo "<font color='#0080FF'><b>" . number_format($tot_date[$k]) . "</b></font>";
                                            } else {
                                                echo number_format($tot_date[$k]);
                                            } ?>
                                </td>
                                <? foreach ($array_adtype as $k1 => $v1) {
                                                foreach ($theadd[$k1] as $k2 => $v2) {
                                                    $realValue           = $S_RETURNVAL['good_type2_price'][$v][$k1][$k2];
                                                    $tot[$k2]           += $S_RETURNVAL['good_type2_price'][$v][$k1][$k2];
                                                    $tot_m_nm[$k1]      += $S_RETURNVAL['good_type2_price'][$v][$k1][$k2];
                                                    // $tot_date[$k]       += $S_RETURNVAL['good_type2_price'][$v][$k1][$k2];
                                                    $grand_tot          += $S_RETURNVAL['good_type2_price'][$v][$k1][$k2];
                                                    $google_tot[$k]     += $S_RETURNVAL['good_type2_price'][$v][$k1][$k2]; ?>
                                        <td class='right'>
                                        <? 
                                                    $new_k = str_replace('-', '', $k);
                                                    $new_k = str_replace('~', '', $new_k);
                                                    $new_k = str_replace(' ', '', $new_k);
                                                    $new_k1 = substr($new_k, 0, 8);
                                                    $new_k2 = substr($new_k, 8, 16);
                                                    if ($realValue == $maxValue_wk[$k2]) {
                                                        echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=date&cal_kind=" . $_GET['cal_kind'] . "&sdate=" . $new_k1 . "&edate=" . $new_k2 . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "','popup');><font color='#FF0000'><b>" . number_format($realValue) . "</b></font></a>";
                                                    } else if ($realValue == $minValue_wk[$k2]) {
                                                        echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=date&cal_kind=" . $_GET['cal_kind'] . "&sdate=" . $new_k1 . "&edate=" . $new_k2 . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "','popup');><font color='#0080FF'><b>" . number_format($realValue) . "</b></font></a>";
                                                    } else {
                                                        echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=date&cal_kind=" . $_GET['cal_kind'] . "&sdate=" . $new_k1 . "&edate=" . $new_k2 . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "','popup');>" . number_format($realValue) . "</a>";
                                                    }
                                                    $rate[$rateIdx][] = $realValue != '' ? $realValue : 0;
                                                ?>
                                        </td>
                                <?        }
                                            }  
                                            $rateIdx++;?>
                            </tr>
                        <? array_push($rows_wk, array($v, $google_tot[$k]));
                                        }
                                        $jsonTable1 = json_encode($rows_wk); ?>
                        </tbody>
                        <? for ($i = 0; $i < count($rate[0]); $i++) {
                                            $rateTotal_one += $rate[1][$i];
                                            $rateTotal_two += $rate[0][$i];
                                        } ?>
                        <tfoot>
                        <? if ($_GET['dr_dr2_from']) { ?>
                            <tr>
                                <th class='center'>증감액</th>
                                <th class='right total b left184' rowspan="1" ><?= number_format($rateTotal_two - $rateTotal_one) ?></th>
                                <? for ($i = 0; $i < count($rate[0]); $i++) { ?>
                                    <th class='right b'>
                                        <? if (count($tot) <= 13) { ?>
                                            <div>
                                            <? } else { ?>
                                                <div style="width:120px">
                                                <? } ?>
                                                <?= number_format($rate[0][$i] - $rate[1][$i]) ?></div>
                                    </th>
                                <? } ?>
                            </tr>
                            <tr>
                                <th class='center'>증감율(%)</th>
                                <th class='right total b left184' rowspan="1" ><?= round(($rateTotal_two - $rateTotal_one) / $rateTotal_one * 100, 1) . '%' ?></th>
                                <? for ($i = 0; $i < count($rate[0]); $i++) { ?>
                                    <th align="right"><?= round(($rate[1][$i] - $rate[0][$i]) / $rate[0][$i] * 100, 1) . '%' ?></th>
                                <? } ?>
                            </tr>
                        <? } else { ?>
                            <tr>
                                <th class='center' rowspan="2" style="left: 0; position: sticky; z-index: 9999;">합계</th>
                                <th class='right total left184' rowspan="2" ><?= number_format($grand_tot) ?></th>
                                <? foreach ($tot as $k => $v) { ?>
                                    <th class='right b'>
                                        <? if (count($tot) <= 13) { ?>
                                            <div>
                                            <? } else { ?>
                                                <div style="width:120px">
                                                <? } ?>
                                                <?= number_format($v) ?></div>
                                    </th>
                                <? } ?>
                            </tr>
                            <tr>
                            <? foreach ($array_adtype as $k => $v) { ?>
                                        <th colspan="<?= $good_type2_cnt_thead[$k] ?>" align="right"><?= number_format($tot_m_nm[$k]) ?></th>
                                    <? }  ?>
                            </tr>
                        <? } ?>
                        </tfoot>





                
                        
            <? }else if($_GET['search_type'] == 'division'){                                        //부문별 주별 ?>
                <?   if(!$_GET['dr_dr2_from']){                                                       //부문별 주별 단일조회?>
                    
                    <? foreach ($S_RETURNVAL2['division1'] as $k => $v) {
                            foreach ($array_adtype as $k1 => $v1) {
                                foreach ($theadd[$k1] as $k2 => $v2) {
                                    $grand_total        += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                                }
                            }
                        } ?>
                        <tbody>
                        <? foreach ($S_RETURNVAL2['division1'] as $k => $v) { ?>
                            <? foreach ($array_adtype as $k1 => $v1) {
                                                    foreach ($theadd[$k1] as $k2 => $v2) {
                                                        $tot_date2[$k]    += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                                                    }
                                                }?>
                            <tr bgcolor="#FFFFFF">
                                <td class='center' bgcolor="#FFFFFF"><?= $_GET['cal_kind'] == "w" || $_GET['cal_kind'] == "wd" ? $k : $k ?></td>
                                <td class='right b total_division <?=$left_position?>' style="background-color: white;">
                                    <?= number_format($tot_date2[$k]) ?>
                                </td>
                                <td class="total" style="background-color: white;">
                                <? $percent = round($tot_date2[$k]/$grand_total*100,1); ?>
                                            <div class="progress-bar" style="float:left; width: 65%; height: 15px; background-color: #dedede; font-weight: 600; font-size: .8rem;">
                                                <div class="progress" style="width: <?=$percent?>%; height: 15px; padding: 0; text-align: center;  background-color: #4F98FF; color: #111;">
                                                </div>        
                                            </div>
                                            <div class="progress-bar" style="float:right; width: 35%; font-weight: 600; font-size: .8rem;">
                                                <?=$percent.'%'?> 
                                            </div>
                                </td>
                                            <? foreach ($array_adtype as $k1 => $v1) {
                                                    foreach ($theadd[$k1] as $k2 => $v2) {
                                                        $realValue2        = $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                                                        $tot2[$k2]        += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                                                        $tot_m_nm2[$k1]    += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                                                        // $tot_date2[$k]    += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                                                        $grand_tot2        += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2];
                                                        $google_tot2[$k]    += $S_RETURNVAL2['good_type2_price2'][$k][$k1][$k2]; ?>
                                        <td class='right'>
                                            <? if ($realValue2 == $maxValue_wk2[$k2]) {
                                                            echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=division&division_type=" . trim($k) . "&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $_GET['dr_dr1_from'] . "&sdate2=" . $_GET['dr_dr1_to'] . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "','popup');><font color='#FF0000'><b>" . number_format($realValue2) . "</b></font></a>";
                                                        } else if ($realValue2 == $minValue_wk2[$k2]) {
                                                            echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=division&division_type=" . trim($k) . "&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $_GET['dr_dr1_from'] . "&sdate2=" . $_GET['dr_dr1_to'] . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "','popup');><font color='#0080FF'><b>" . number_format($realValue2) . "</b></font></a>";
                                                        } else {
                                                            echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=division&division_type=" . trim($k) . "&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $_GET['dr_dr1_from'] . "&sdate2=" . $_GET['dr_dr1_to'] . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "','popup');>" . number_format($realValue2) . "</a>";
                                                        } ?>
                                        </td>
                                                <? }
                                            } ?>

                            </tr>
                        <? } ?>
                        </tbody>
                        <tfoot>
                            <tr>
                                <th class='center' rowspan="2" style="left: 0; position: sticky; z-index: 9999; background-color: #E9E9E9;">합계</th>
                                <th class='right total_division b <?=$left_position?>'  rowspan="2"><?= number_format($grand_tot2)//전체 합계 ?></th>
                                <th class='right total' rowspan="2" style="text-align: center; vertical-align: middle;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<?= number_format($grand_tot2) ?>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                                <? foreach ($tot2 as $k => $v) { ?>
                                    <th class='right b'>
                                        <? if (count($tot2) <= 13) { ?>
                                            <div>
                                            <? } else { ?>
                                                <div style="width:120px">
                                                <? } ?>
                                                <?= number_format($v) ?></div>
                                    </th>
                                <? } ?>
                            </tr>
                            <tr>
                            <? foreach ($array_adtype as $k => $v) { ?>
                                <th colspan="<?= $good_type2_cnt_thead2[$k] ?>" align="right"><?= number_format($tot_m_nm2[$k]) ?>
                                </th>
                            <? } ?> 
                            </tr>
                            </tfoot>
                    <? 
                    $idxCnt = 1;
            
                                }
                            
            }else if($_GET['search_type'] == 'customer'){                                           // 광고주별 주별 ?>
                        <tbody>
                <?
                    foreach ($S_RETURNVAL3['cs_seq'] as $k => $v) {  ?>
                     <?  foreach ($array_adtype as $k1 => $v1) {
                                        foreach ($S_RETURNVAL3['good_type23'][$k1] as $k2 => $v2) {
                                            $tot_date3[$k]      += $S_RETURNVAL3['good_type2_price3'][$k][$k1][$k2];
                                        }
                                    } ?>
                    <tr bgcolor="#FFFFFF">
                        <td class='center' bgcolor="#FFFFFF"><?= $_GET['cal_kind'] == "w" || $_GET['cal_kind'] == "wd" ? $k : $k ?></td>
                        <td class='right b left184' style="background-color: #FFFFFF;">
                            <? if ($tot_date3[$k] == $maxDateValue_wk3) { // 작업 진행 중
                                echo "<font color='#FF0000'>" . number_format($tot_date3[$k]) . "</font>";
                            } else if ($tot_date3[$k] == $minDateValue_wk3) {
                                echo "<font color='#0080FF'>" . number_format($tot_date3[$k]) . "</font>";
                            } else {
                                echo number_format($tot_date3[$k]);
                            }
                            ?></td>
                        <?  foreach ($array_adtype as $k1 => $v1) {
                                        foreach ($theadd[$k1] as $k2 => $v2) {
                                            $realValue3         = $S_RETURNVAL3['good_type2_price3'][$k][$k1][$k2];
                                            $tot3[$k2]          += $S_RETURNVAL3['good_type2_price3'][$k][$k1][$k2];
                                            $tot_m_nm3[$k1]     += $S_RETURNVAL3['good_type2_price3'][$k][$k1][$k2];
                                            $grand_tot3         += $S_RETURNVAL3['good_type2_price3'][$k][$k1][$k2];
                                            $google_tot3[$k]    += $S_RETURNVAL3['good_type2_price3'][$k][$k1][$k2]; ?>
                                        <td class='right'>
                                            <? if ($realValue3 == $maxValue3[$k2]) {
                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=customer&cs_nm=" . $v . "&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $_GET['dr_dr1_from'] . "&sdate2=" . $_GET['dr_dr1_to'] . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "','popup');><font color='#FF0000'><b>" . number_format($realValue3) . "</b></font></a>";
                                                } else if ($realValue3 == $minValue3[$k2]) {
                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=customer&cs_nm=" . $v . "&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $_GET['dr_dr1_from'] . "&sdate2=" . $_GET['dr_dr1_to'] . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "','popup');><font color='#0080FF'><b>" . number_format($realValue3) . "</b></font></a>";
                                                } else {
                                                    echo "<a href=javascript:openWindowPop('/report/sales/pop_sales_cslist.php?type=customer&cs_nm=" . $v . "&cal_kind=" . $_GET['cal_kind'] . "&sdate1=" . $_GET['dr_dr1_from'] . "&sdate2=" . $_GET['dr_dr1_to'] . "&code4=" . $k1 . "&good_type2=" . $v2 . "&division1=" . $_GET['division1'] . "&division2=" . $_GET['division2'] . "&em_seq=" . $_GET['em_nm'] . "','popup');>" . number_format($realValue3) . "</a>";
                                                } ?>
                                        </td>
                                        <? }
                                } ?>
                            </tr>
                        <?  } ?>
                        </tbody>
                <tfoot>
                    <tr>
                        <th class='center' rowspan="2">합계</th>
                        <th class='right left184' rowspan="2"><div style="width:60px"><?= number_format($grand_tot3) ?></th></div>
                        <? foreach ($tot3 as $k => $v) { ?>
                            <th class='right b total'>
                                <? if (count($tot3) <= 13) { ?>
                                    <div>
                                    <? } else { ?>
                                        <div style="width:120px">
                                        <? } ?>
                                        <?= number_format($v) ?></div>
                            </th>
                        <? } ?>
                    </tr>
                    <tr>
                        <? foreach ($array_adtype as $k => $v) { ?>
                            <th colspan="<?= $good_type2_cnt_thead[$k] ?>" align="right"><?= number_format($tot_m_nm3[$k]) ?></span></th>
                        <? } ?>
                    </tr>
                </tfoot>
                    <?
                }
            

        }//주별 끝 ?>
        </table>
    </div>
<div>&nbsp;</div><div>&nbsp;</div>
<!-- 차트 합계 데이터 가공 -->
    <? 
        if ($_GET['dr_dr2_from'] !== "") {
            $row_chart[] = array('year', $start_date, $end_date);
        } else {
            $row_chart[] = array('year', $start_date);
        }
        if (!is_array($S_RETURNVAL['pay_date'])) {
            array_push($row_chart, array(0, 0, 0));
        }
        foreach ($S_RETURNVAL['pay_date'] as $k => $v) {
            foreach ($array_adtype as $k1 => $v1) {
                foreach ($S_RETURNVAL['good_type2'][$k1] as $k2 => $v2) {
                    $google_tot_chart[$k]     += $S_RETURNVAL['good_type2_price'][$k][$k1][$k2];
                    $tot_date_chart[$k]       += $S_RETURNVAL['good_type2_price'][$k][$k1][$k2];
                }
            }
            if ($_GET['dr_dr2_from']) {
                array_push($row_chart, array($_GET['cal_kind'] == "w" || $_GET['cal_kind'] == "wd" ? $k : $k, $google_tot_chart[$k], $tot_date_chart[$k]));
            } else {
                array_push($row_chart, array($_GET['cal_kind'] == "w" || $_GET['cal_kind'] == "wd" ? $k : $k, $google_tot_chart[$k]));
            }
        }
        $jsonTable2 = json_encode($row_chart); 
        // print_r($jsonTable1);
    ?>
<!-- Default 데이터 0인 달력 -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            var data = google.visualization.arrayToDataTable([
            ['Year', '합계'],
            ['0',  0]
            ]);

            var options = {
                    curveType: 'function',
                    legend: {
                        position: 'bottom'
                    },
                    fontSize: 11,
                    backgroundColor: '#f8f8f8',
                    chartArea: {
                        left: 100,
                        top: 20,
                        width: "90%",
                        height: "70%"
                    },
                    vAxis: {
                        minValue: 0
                    },
                };
                var chart = new google.visualization.AreaChart(document.getElementById('chart_div'));
                chart.draw(data, options);
        }
    </script>

<!-- 차트 그리기 -->
    <? // 연별 조회시 그래프 범주 영역
            $dateone = $_GET['dr_dr1_from'][0].$_GET['dr_dr1_from'][1].$_GET['dr_dr1_from'][2].$_GET['dr_dr1_from'][3];
            $datetwo = $_GET['dr_dr1_to'][0].$_GET['dr_dr1_to'][1].$_GET['dr_dr1_to'][2].$_GET['dr_dr1_to'][3];
            if($dateone !== $datetwo){
                for($i=$dateone; $i<=$datetwo; $i++){
                    $chartYearList[] = $i;
                }
            }else{
                $chartYearList[] = $dateone;
            }
        ?>
        <script>
            var yearList = <?=json_encode($chartYearList)?>;
        </script>

    <script type="text/javascript">

        function createCustomHTMLContent(date1, val1, date2, val2,) {
            let a='';
            let b='';
            if(date1){ a = '<div style="vertical-align: middle;"><font color="#FF8C00">∎&nbsp;</font>'+date1+':  <b>'+val1.toLocaleString()+'</b> </div>';}
            if(date2){ b = '<div style="vertical-align: middle;"><font color="#7b68ee">∎&nbsp;</font>'+date2+':  <b>'+val2.toLocaleString()+'</b> </div>';}

            return `<div style="padding:5px 5px 5px 5px;">${a}${b}</div>`; //리터럴
        }
        google.charts.load('current', {
            'packages': ['corechart']
        });
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            <? if ($_GET['dr_r2_to']) { ?>
                var resultData = <?= json_encode($chart_RETURNVAL) ?>;
                if (resultData != -1) {
                    var data = new google.visualization.DataTable();
                    data.addColumn('string', 'date');
                    data.addColumn({'type': 'string', 'role': 'tooltip', 'p': {'html': true}});
                    data.addColumn('number', '<?= $start_date?>');
                    data.addColumn({
                        type: 'number',
                        role: 'annotation'
                    });
                    if (resultData['pay_price'][3] != null) {
                        data.addColumn('number', '<?= $end_date ?>');
                        data.addColumn({
                            type: 'number',
                            role: 'annotation'
                        });
                    }
                    var idx = 0;
                    if("<?=$_GET['cal_kind']?>" !== "wk"){
                        var pay_date2 = 'pay_date2';
                        var pay_date = 'pay_date';
                    }else{
                        var pay_date2 = 'pay_date_wk';
                        var pay_date = 'pay_date_wk_count';
                    }
                    console.log(resultData);
                    for (var key in resultData[pay_date]) {
                        if (resultData['pay_price'][1] != null && resultData['pay_price'][3] != null) {
                            data.addRow([
                                resultData[pay_date2][key],
                                createCustomHTMLContent(
                                    resultData['pay_date_list'][1][key]==undefined ? '' : resultData[pay_date2][key],
                                    resultData['pay_price'][1][resultData[pay_date][key]] ==undefined ? '' :  resultData['pay_price'][1][resultData[pay_date][key]],
                                    resultData['pay_date_list'][3][key] ==undefined ? '' : resultData['pay_date_list'][3][key], 
                                    resultData['pay_price'][3][resultData[pay_date][key]] ==undefined ? '' : resultData['pay_price'][3][resultData[pay_date][key]] 
                                ),
                                resultData['pay_price'][1][resultData[pay_date][key]] > 0 ? resultData['pay_price'][1][resultData[pay_date][key]] : 0,
                                resultData['pay_price'][1][resultData[pay_date][key]] > 0 ? resultData['pay_price'][1][resultData[pay_date][key]] : 0,
                                resultData['pay_price'][3][resultData[pay_date][key]] > 0 ? resultData['pay_price'][3][resultData[pay_date][key]] : 0,
                                resultData['pay_price'][3][resultData[pay_date][key]] > 0 ? resultData['pay_price'][3][resultData[pay_date][key]] : 0
                                
                            ]);
                        } 
                        idx++;
                    }
                    console.log(data);
                    
                    var options = {
                        animation: {
                            duration: 1000,
                            easing: 'inAndOut',
                            startup: true
                        },

                        curveType: 'function',

                        legend: {
                            position: 'top', //막대별 제목
                            maxLines: 2,
                            alignment: 'start'
                        },

                        fontSize: 11,

                        backgroundColor: '#f8f8f8',

                        chartArea: {
                            right: 50,
                            left: 90,
                            top: 30,
                            bottom : 30,
                            // width: "90%",
                            width: "90%",
                            height: "70%"
                        },
                        
                        colors:['#FF8C00','#7b68ee'] //라인 색
                        
                        ,pointShape: 'circle'
                        
                        ,series: { //라인 영역 색 채우기
                            0: {
                                areaOpacity: 0,
                            },
                            // 1: {
                            //     areaOpacity: 0
                            // }
                        },
                        focusTarget: 'category', //두가지 라인 tooltip동시에 보여주기
                        vAxis: {
                            minValue: 0,
                        }
                        ,hAxis: {
                            format :'',
                            },
                            
                        tooltip: { isHtml: true},
                        // p: {'html': true},
                        // backgroundColor: { 배경색
                        // fill: '#FFFFFF' 
                        // },
                        // tooltip: { 
                            // trigger: 'selection' ,
                            // isHtml: true
                        // },
                    };
                } else {
                    var data = new google.visualization.DataTable({
                        cols: [{
                                label: 'date',
                                type: 'string'
                            },
                            {
                                label: '<?= $start_date ?>',
                                type: 'number'
                            },
                            {
                                label: '<?= $end_date ?>',
                                type: 'number'
                            },
                            {
                                role: 'annotation',
                                type: 'string'
                            }
                        ]
                    });
                    data.addRows([
                        ['', 0, 0, 'No Data Copy']
                    ]);

                }
                var chart = new google.visualization.AreaChart(document.getElementById('chart_div'));
                chart.draw(data, options);


            <? } else { ?>
                // 날짜가 1개만 선택 되었을 때   
                <? if($_GET['search_type'] == 'date'){?>
                    var data = google.visualization.arrayToDataTable(<?= $jsonTable1 ?>);
                <? }else{?>
                    var data = google.visualization.arrayToDataTable(<?= $jsonTable2 ?>);
                <? } ?>
                var options = {
                    curveType: 'function',
                    legend: {
                        position: 'left'
                    },
                    fontSize: 11,
                    backgroundColor: '#f8f8f8',
                    color: '#FF8C00', //라인 색
                    chartArea: {
                        left: 90,
                        right : 50,
                        top: 20,
                        width: "90%",
                        height: "80%"
                    },
                    vAxis: {
                        minValue: 0,
                    }
                    ,hAxis: {
                        format :'',
                        },
                    animation: {
                        duration: 1000,
                        easing: 'inAndOut',
                        startup: true
                    },
                    focusTarget: 'category', //두가지 라인 tooltip동시에 보여주기
                    
                }
                var chart = new google.visualization.AreaChart(document.getElementById('chart_div'));
                chart.draw(data, options);
                // alert(yearList);
            <? } ?>
        }
    </script>

<!-- dateRangesWidget실행 -->
    <script type="text/javascript">
        $('.pickerContainer').DateRangesWidget();
        
    </script>

<!-- 광고유형 광고매체 라디오버튼 클릭시 목록 초기화 -->
    <script>
        var radio_ad = document.querySelectorAll('#ad_type')[0];
        var radio_mnm = document.querySelectorAll('#m_nm')[0];
        var m_nm = document.querySelectorAll('#m_nm');
        var ad_type = document.querySelectorAll('#ad_type');

        // 매체별 클릭시 매체요소 check & 유형별false && 유형요소 false
        radio_mnm.addEventListener('click', event => {//매체별 클릭시
            for (var i = 0; i < ad_type.length; i++) {
                ad_type[i].checked = false; //유형별 요소들 false
            }
            for (var i = 0; i < m_nm.length; i++) {
                m_nm[i].checked = true;//매체별 요소들 check
            }
            radio_ad.checked = false; //유형별 false
        })
        // 유형별 클릭시 유형요소 check & 매체별false && 매체요소 false
        radio_ad.addEventListener('click', event => {//유형별 클릭시
            for (var i = 0; i < m_nm.length; i++) {
                m_nm[i].checked = false;//매체별 요소들 false
            }
            for (var i = 0; i < ad_type.length; i++) {
                ad_type[i].checked = true; //유형별 요소들 check
            }
            radio_mnm.checked = false;// 매체별 false
        })
        //유형요소 클릭시 유형별 check & 매체요소 false
        for (var i = 0; i < ad_type.length; i++) { // 유형별 요소 클릭시
            ad_type[i].addEventListener('click', event => {
                radio_ad.checked = true;
                for (var i = 0; i < m_nm.length; i++) {
                m_nm[i].checked = false;//매체별 요소들 false
            }
            })
        }
        //매체요소 클릭시 매체별 check & 유형요소 false
        for (var i = 0; i < m_nm.length; i++) { // 매체별 요소 클릭시
            m_nm[i].addEventListener('click', event => {
                radio_mnm.checked = true;
                for (var i = 0; i < ad_type.length; i++) {
                ad_type[i].checked = false; //유형별 요소들 check
            }
            })
        }
    </script>

<!-- 달력 영역 -->
    <script>
        // 선택한 날짜 계속 유지
        <? if ($_GET['dr_dr1_from']) { // 날짜가 1개만 선택된경우 선택 날짜 sapn태그와 input태그에 설정?>
            var spans = document.getElementsByClassName('date-range-field')[0]['childNodes'][1];
            var inputs1 = document.querySelectorAll('#datepicker-dropdown > div.date-ranges-form > div.main-daterange > input.dr.dr1.from');
            var inputs2 = document.querySelectorAll('#datepicker-dropdown > div.date-ranges-form > div.main-daterange > input.dr.dr1.to');
            var widgetDiv = document.querySelector('#container > div.item > div > div');
            $(spans).text("<?= $start_date ?>");
            $(inputs1[0]).val("<?= $sdate_one ?>");
            $(inputs2[0]).val("<?= $sdate_two ?>");

            $(widgetDiv).on("click", function(){
                setTimeout(function() {
                    $(inputs1[0]).val("<?= $sdate_one ?>");
                    $(inputs2[0]).val("<?= $sdate_two ?>");
                }, 100);
            })
        <? } ?>
        <? if ($_GET['dr_dr2_from']) { // 비교 대상 날짜까지 선택된경우 선택 날짜 sapn태그와 input태그에 설정 ?>
            var spans2 = document.getElementsByClassName('date-range-field')[0]['childNodes'][2];
            var inputs2_1 = document.querySelectorAll('#datepicker-dropdown > div.date-ranges-form > div.comparison-daterange > input.dr.dr2.from');
            var inputs2_2 = document.querySelectorAll('#datepicker-dropdown > div.date-ranges-form > div.comparison-daterange > input.dr.dr2.to');
            var widgetDiv = document.querySelector('#container > div.item > div > div');

            spans2.style.display = 'block';

            $(spans2).text("<?= $end_date ?>");
            $(inputs2_1[0]).val("<?= $edate_one ?>");
            $(inputs2_2[0]).val("<?= $edate_two ?>");

            $(widgetDiv).on("click", function(){
                setTimeout(function() {
                    $(inputs1[0]).val("<?= $sdate_one ?>");
                    $(inputs2[0]).val("<?= $sdate_two ?>");
                    $(inputs2_1[0]).val("<?= $edate_one ?>");
                    $(inputs2_2[0]).val("<?= $edate_two ?>");
                }, 100);
            })        
            var checkBtn2 = document.querySelector('#datepicker-dropdown > div.date-ranges-form > div:nth-child(2) > input');
            $(checkBtn2).prop("checked", true);   
        <? } ?>
        <? if (!$_GET['dr_dr1_from']) { // 선택날짜가 없는경우 Default로 1일부터 어제 날자까지 span과 input태그에 설정 ?>
            var OneOfDay = new Date(new Date().getFullYear(), new Date().getMonth(), 1).toLocaleDateString().slice(0,-1).replace(/(\s*)/g, "").replaceAll('.','-');
            var yesterdays = new Date(new Date().setDate(day - 1)).toLocaleDateString().slice(0,-1).replace(/(\s*)/g, "").replaceAll('.','-');
            var inputs1 = document.querySelectorAll('#datepicker-dropdown > div.date-ranges-form > div.main-daterange > input.dr.dr1.from');
            var inputs2 = document.querySelectorAll('#datepicker-dropdown > div.date-ranges-form > div.main-daterange > input.dr.dr1.to');
            var widgetDiv = document.querySelector('#container > div.item > div > div');
            // console.log(OneOfDay);
            // console.log(yesterdays);
            $(widgetDiv).on("click", function(){
                setTimeout(function() {
                    $(inputs1[0]).val(OneOfDay);
                    $(inputs2[0]).val(yesterdays);
                    console.log(inputs1[0]);
                    console.log(inputs2[0]);
                }, 100);
            })
        <? } ?>
        
        $(".enable-comparison").change(function(){ // 비교대상 체크시 input영역 초기화
            var compareDiv = document.querySelector('#datepicker-dropdown > div.date-ranges-form > div.comparison-daterange');
            var compareDiv2 = document.querySelector('#datepicker-dropdown > div.date-ranges-form > div:nth-child(2) > select');
            var compareBtnDiv = document.querySelector('#datepicker-dropdown > div.date-ranges-form > div.btn-group');
            var inputs1 = document.querySelectorAll('#datepicker-dropdown > div.date-ranges-form > div.main-daterange > input.dr.dr1.from');
            var inputs2 = document.querySelectorAll('#datepicker-dropdown > div.date-ranges-form > div.main-daterange > input.dr.dr1.to');
            var inputs2_1 = document.querySelectorAll('#datepicker-dropdown > div.date-ranges-form > div.comparison-daterange > input.dr.dr2.from');
            var inputs2_2 = document.querySelectorAll('#datepicker-dropdown > div.date-ranges-form > div.comparison-daterange > input.dr.dr2.to');
            if($(".enable-comparison").is(":checked")){
                $(compareDiv).show();
                $(compareDiv2).show();
                $(compareBtnDiv).css("margin-top","0"); 
                $(inputs2_1[0]).val("");
                $(inputs2_2[0]).val("");
            }else{
                $(compareDiv2).hide();
                $(compareDiv).hide();
                $(compareBtnDiv).css("margin-top","32px");
                $(inputs2_1[0]).val("");
                $(inputs2_2[0]).val("");
            }
        });    
    </script>
<!-- 광고주영역 검색어 없을 시 alert창 -->
    <script>
        const cust_select_option = $('#searchSelect').val(); // 기본값 1
        const customer_string = document.querySelector('#inputString').value; // 검색어
        if(cust_select_option !== '1' && customer_string == ''){
            alert('광고주 정보를 입력해주세요');
            window.history.back();
        }
    </script>
<!-- 유형별 매체별 구분선 -->
    <script>
        if("<?= $_GET['search_type']?>" =='date'){
            if("<?= $_GET['check1']?>" ==1){
                const boder_right = "2px solid #cccccc";
            //유형
                //검색유형
                    const thead1 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(3)')[0];
                    thead1.style.borderRight=boder_right;
                    const thead2 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(6)')[0];
                    thead2.style.borderRight=boder_right;
                    const tdList = ($('#tablereport_date > tbody > tr > td:nth-child(8)'));
                    for($i=0;$i<tdList.length;$i++){
                        tdList[$i].style.borderRight=boder_right;
                    }
                    const tfoot1 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(8)')[0];
                    tfoot1.style.borderRight=boder_right;
                    const tfoot2 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(1)')[0];
                    tfoot2.style.borderRight=boder_right;


                //배너유형
                    const thead1_2 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(4)')[0];
                    thead1_2.style.borderRight=boder_right;
                    const thead2_2 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(16)')[0];
                    thead2_2.style.borderRight=boder_right;
                    const tdList_2 = ($('#tablereport_date > tbody > tr > td:nth-child(18)'));
                    for($i=0;$i<tdList.length;$i++){
                        tdList_2[$i].style.borderRight=boder_right;
                    }
                    const tfoot1_2 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(18)')[0];
                    tfoot1_2.style.borderRight=boder_right;
                    const tfoot2_2 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(2)')[0];
                    tfoot2_2.style.borderRight=boder_right;


                // 커머스유형
                    const thead1_3 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(5)')[0];
                    thead1_3.style.borderRight=boder_right;
                    const thead2_3 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(25)')[0];
                    thead2_3.style.borderRight=boder_right;
                    const tdList_3 = ($('#tablereport_date > tbody > tr > td:nth-child(27)'));
                    for($i=0;$i<tdList.length;$i++){
                        tdList_3[$i].style.borderRight=boder_right;
                    }
                    const tfoot1_3 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(27)')[0];
                    tfoot1_3.style.borderRight=boder_right;
                    const tfoot2_3 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(3)')[0];
                    tfoot2_3.style.borderRight=boder_right;


                //컨텐츠유형
                    const thead1_4 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(6)')[0];
                    thead1_4.style.borderRight=boder_right;
                    const thead2_4 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(30)')[0];
                    thead2_4.style.borderRight=boder_right;
                    const tdList_4 = ($('#tablereport_date > tbody > tr > td:nth-child(32)'));
                    for($i=0;$i<tdList.length;$i++){
                        tdList_4[$i].style.borderRight=boder_right;
                    }
                    const tfoot1_4 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(32)')[0];
                    tfoot1_4.style.borderRight=boder_right;
                    const tfoot2_4 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(4)')[0];
                    tfoot2_4.style.borderRight=boder_right;


            }else if("<?= $_GET['check1']?>" ==2){
                const boder_right = "2px solid #cccccc";
            //매체
                // 네이버
                    const thead1 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(3)')[0];
                    thead1.style.borderRight=boder_right;
                    const thead2 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(10)')[0];
                    thead2.style.borderRight=boder_right;
                    const tdList = ($('#tablereport_date > tbody > tr > td:nth-child(12)'));
                    for($i=0;$i<tdList.length;$i++){
                        tdList[$i].style.borderRight=boder_right;
                    }
                    const tfoot1 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(12)')[0];
                    tfoot1.style.borderRight=boder_right;
                    const tfoot2 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(1)')[0];
                    tfoot2.style.borderRight=boder_right;


                // 카카오
                    const thead1_2 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(4)')[0];
                    thead1_2.style.borderRight=boder_right;
                    const thead2_2 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(14)')[0];
                    thead2_2.style.borderRight=boder_right;
                    const tdList_2 = ($('#tablereport_date > tbody > tr > td:nth-child(16)'));
                    for($i=0;$i<tdList_2.length;$i++){
                        tdList_2[$i].style.borderRight=boder_right;
                    }
                    const tfoot1_2 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(16)')[0];
                    tfoot1_2.style.borderRight=boder_right;
                    const tfoot2_2 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(2)')[0];
                    tfoot2_2.style.borderRight=boder_right;


                // 네이트
                    const thead1_3 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(5)')[0];
                    thead1_3.style.borderRight=boder_right;
                    const thead2_3 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(15)')[0];
                    thead2_3.style.borderRight=boder_right;
                    const tdList_2_3 = ($('#tablereport_date > tbody > tr > td:nth-child(17)'));
                    for($i=0;$i<tdList_2_3.length;$i++){
                        tdList_2_3[$i].style.borderRight=boder_right;
                    }
                    const tfoot1_3 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(17)')[0];
                    tfoot1_3.style.borderRight=boder_right;
                    const tfoot2_3 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(3)')[0];
                    tfoot2_3.style.borderRight=boder_right;

                //크리테오
                    const thead1_4 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(6)')[0];
                    thead1_4.style.borderRight=boder_right;
                    const thead2_4 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(16)')[0];
                    thead2_4.style.borderRight=boder_right;
                    const tdList_2_4 = ($('#tablereport_date > tbody > tr > td:nth-child(18)'));
                    for($i=0;$i<tdList_2_4.length;$i++){
                        tdList_2_4[$i].style.borderRight=boder_right;
                    }
                    const tfoot1_4 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(18)')[0];
                    tfoot1_4.style.borderRight=boder_right;
                    const tfoot2_4 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(4)')[0];
                    tfoot2_4.style.borderRight=boder_right;

                // 와이더플래닛
                    const thead1_5 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(7)')[0];
                    thead1_5.style.borderRight=boder_right;
                    const thead2_5 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(17)')[0];
                    thead2_5.style.borderRight=boder_right;
                    const tdList_2_5 = ($('#tablereport_date > tbody > tr > td:nth-child(19)'));
                    for($i=0;$i<tdList_2_5.length;$i++){ tdList_2_5[$i].style.borderRight=boder_right;}
                    const tfoot1_5 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(19)')[0];
                    tfoot1_5.style.borderRight=boder_right;
                    const tfoot2_5 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(5)')[0];
                    tfoot2_5.style.borderRight=boder_right;

                //인라이플
                    const thead1_6 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(8)')[0];
                    thead1_6.style.borderRight=boder_right;
                    const thead2_6 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(18)')[0];
                    thead2_6.style.borderRight=boder_right;
                    const tdList_2_6 = ($('#tablereport_date > tbody > tr > td:nth-child(20)'));
                    for($i=0;$i<tdList_2_6.length;$i++){ tdList_2_6[$i].style.borderRight=boder_right;}
                    const tfoot1_6 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(20)')[0];
                    tfoot1_6.style.borderRight=boder_right;
                    const tfoot2_6 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(6)')[0];
                    tfoot2_6.style.borderRight=boder_right;

                //리얼클릭
                    const thead1_7 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(9)')[0];
                    thead1_7.style.borderRight=boder_right;
                    const thead2_7 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(19)')[0];
                    thead2_7.style.borderRight=boder_right;
                    const tdList_2_7 = ($('#tablereport_date > tbody > tr > td:nth-child(21)'));
                    for($i=0;$i<tdList_2_7.length;$i++){ tdList_2_7[$i].style.borderRight=boder_right;}
                    const tfoot1_7 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(21)')[0];
                    tfoot1_7.style.borderRight=boder_right;
                    const tfoot2_7 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(7)')[0];
                    tfoot2_7.style.borderRight=boder_right;

                //레인보우
                    const thead1_8 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(10)')[0];
                    thead1_8.style.borderRight=boder_right;
                    const thead2_8 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(20)')[0];
                    thead2_8.style.borderRight=boder_right;
                    const tdList_2_8 = ($('#tablereport_date > tbody > tr > td:nth-child(22)'));
                    for($i=0;$i<tdList_2_8.length;$i++){ tdList_2_8[$i].style.borderRight=boder_right;}
                    const tfoot1_8 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(22)')[0];
                    tfoot1_8.style.borderRight=boder_right;
                    const tfoot2_8 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(8)')[0];
                    tfoot2_8.style.borderRight=boder_right;

                //메타
                    const thead1_9 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(11)')[0];
                    thead1_9.style.borderRight=boder_right;
                    const thead2_9 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(21)')[0];
                    thead2_9.style.borderRight=boder_right;
                    const tdList_2_9 = ($('#tablereport_date > tbody > tr > td:nth-child(23)'));
                    for($i=0;$i<tdList_2_9.length;$i++){ tdList_2_9[$i].style.borderRight=boder_right;}
                    const tfoot1_9 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(23)')[0];
                    tfoot1_9.style.borderRight=boder_right;
                    const tfoot2_9 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(9)')[0];
                    tfoot2_9.style.borderRight=boder_right;

                //지마켓
                    const thead1_10 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(12)')[0];
                    thead1_10.style.borderRight=boder_right;
                    const thead2_10 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(22)')[0];
                    thead2_10.style.borderRight=boder_right;
                    const tdList_2_10 = ($('#tablereport_date > tbody > tr > td:nth-child(24)'));
                    for($i=0;$i<tdList_2_10.length;$i++){ tdList_2_10[$i].style.borderRight=boder_right;}
                    const tfoot1_10 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(24)')[0];
                    tfoot1_10.style.borderRight=boder_right;
                    const tfoot2_10 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(10)')[0];
                    tfoot2_10.style.borderRight=boder_right;


                //11번가
                    const thead1_11 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(13)')[0];
                    thead1_11.style.borderRight=boder_right;
                    const thead2_11 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(23)')[0];
                    thead2_11.style.borderRight=boder_right;
                    const tdList_2_11 = ($('#tablereport_date > tbody > tr > td:nth-child(25)'));
                    for($i=0;$i<tdList_2_11.length;$i++){ tdList_2_11[$i].style.borderRight=boder_right;}
                    const tfoot1_11 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(25)')[0];
                    tfoot1_11.style.borderRight=boder_right;
                    const tfoot2_11 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(11)')[0];
                    tfoot2_11.style.borderRight=boder_right;


                //위메프
                    const thead1_12 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(14)')[0];
                    thead1_12.style.borderRight=boder_right;
                    const thead2_12 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(24)')[0];
                    thead2_12.style.borderRight=boder_right;
                    const tdList_2_12 = ($('#tablereport_date > tbody > tr > td:nth-child(26)'));
                    for($i=0;$i<tdList_2_12.length;$i++){ tdList_2_12[$i].style.borderRight=boder_right;}
                    const tfoot1_12 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(26)')[0];
                    tfoot1_12.style.borderRight=boder_right;
                    const tfoot2_12 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(12)')[0];
                    tfoot2_12.style.borderRight=boder_right;


                //티몬
                    const thead1_13 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(15)')[0];
                    thead1_13.style.borderRight=boder_right;
                    const thead2_13 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(25)')[0];
                    thead2_13.style.borderRight=boder_right;
                    const tdList_2_13 = ($('#tablereport_date > tbody > tr > td:nth-child(27)'));
                    for($i=0;$i<tdList_2_13.length;$i++){ tdList_2_13[$i].style.borderRight=boder_right;}
                    const tfoot1_13 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(27)')[0];
                    tfoot1_13.style.borderRight=boder_right;
                    const tfoot2_13 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(13)')[0];
                    tfoot2_13.style.borderRight=boder_right;

                //인터파크
                    const thead1_14 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(16)')[0];
                    thead1_14.style.borderRight=boder_right;
                    const thead2_14 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(26)')[0];
                    thead2_14.style.borderRight=boder_right;
                    const tdList_2_14 = ($('#tablereport_date > tbody > tr > td:nth-child(28)'));
                    for($i=0;$i<tdList_2_14.length;$i++){ tdList_2_14[$i].style.borderRight=boder_right;}
                    const tfoot1_14 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(28)')[0];
                    tfoot1_14.style.borderRight=boder_right;
                    const tfoot2_14 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(14)')[0];
                    tfoot2_14.style.borderRight=boder_right;

                //다나와
                    const thead1_15 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(17)')[0];
                    thead1_15.style.borderRight=boder_right;
                    const thead2_15 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(27)')[0];
                    thead2_15.style.borderRight=boder_right;
                    const tdList_2_15 = ($('#tablereport_date > tbody > tr > td:nth-child(29)'));
                    for($i=0;$i<tdList_2_15.length;$i++){ tdList_2_15[$i].style.borderRight=boder_right;}
                    const tfoot1_15 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(29)')[0];
                    tfoot1_15.style.borderRight=boder_right;
                    const tfoot2_15 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(15)')[0];
                    tfoot2_15.style.borderRight=boder_right;       
                    
                    
                //쿠팡
                    const thead1_16 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(18)')[0];
                    thead1_16.style.borderRight=boder_right;
                    const thead2_16 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(28)')[0];
                    thead2_16.style.borderRight=boder_right;
                    const tdList_2_16 = ($('#tablereport_date > tbody > tr > td:nth-child(30)'));
                    for($i=0;$i<tdList_2_16.length;$i++){ tdList_2_16[$i].style.borderRight=boder_right;}
                    const tfoot1_16 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(30)')[0];
                    tfoot1_16.style.borderRight=boder_right;
                    const tfoot2_16 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(16)')[0];
                    tfoot2_16.style.borderRight=boder_right;   

                //코이즈
                    const thead1_17 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(19)')[0];
                    thead1_17.style.borderRight=boder_right;
                    const thead2_17 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(29)')[0];
                    thead2_17.style.borderRight=boder_right;
                    const tdList_2_17 = ($('#tablereport_date > tbody > tr > td:nth-child(31)'));
                    for($i=0;$i<tdList_2_17.length;$i++){ tdList_2_17[$i].style.borderRight=boder_right;}
                    const tfoot1_17 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(31)')[0];
                    tfoot1_17.style.borderRight=boder_right;
                    const tfoot2_17 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(17)')[0];
                    tfoot2_17.style.borderRight=boder_right;  
                    
                //바이럴
                    const thead1_18 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(20)')[0];
                    thead1_18.style.borderRight=boder_right;
                    const thead2_18 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(30)')[0];
                    thead2_18.style.borderRight=boder_right;
                    const tdList_2_18 = ($('#tablereport_date > tbody > tr > td:nth-child(32)'));
                    for($i=0;$i<tdList_2_18.length;$i++){ tdList_2_18[$i].style.borderRight=boder_right;}
                    const tfoot1_18 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(32)')[0];
                    tfoot1_18.style.borderRight=boder_right;
                    const tfoot2_18 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(18)')[0];
                    tfoot2_18.style.borderRight=boder_right;  
                    
                    
                //구글
                    const thead1_19 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(21)')[0];
                    thead1_19.style.borderRight=boder_right;
                    const thead2_19 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(31)')[0];
                    thead2_19.style.borderRight=boder_right;
                    const tdList_2_19 = ($('#tablereport_date > tbody > tr > td:nth-child(33)'));
                    for($i=0;$i<tdList_2_19.length;$i++){ tdList_2_19[$i].style.borderRight=boder_right;}
                    const tfoot1_19 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(33)')[0];
                    tfoot1_19.style.borderRight=boder_right;
                    const tfoot2_19 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(19)')[0];
                    tfoot2_19.style.borderRight=boder_right;  

                //위사
                    const thead1_20 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(22)')[0];
                    thead1_20.style.borderRight=boder_right;
                    const thead2_20 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(32)')[0];
                    thead2_20.style.borderRight=boder_right;
                    const tdList_2_20 = ($('#tablereport_date > tbody > tr > td:nth-child(34)'));
                    for($i=0;$i<tdList_2_20.length;$i++){ tdList_2_20[$i].style.borderRight=boder_right;}
                    const tfoot1_20= $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(34)')[0];
                    tfoot1_20.style.borderRight=boder_right;
                    const tfoot2_20 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(20)')[0];
                    tfoot2_20.style.borderRight=boder_right;         


            } 
        }else if("<?= $_GET['search_type']?>" =='division'){
            if("<?= $_GET['check1']?>" ==1){
                const boder_right = "2px solid #cccccc";
                //유형
                    //검색유형
                        // const thead1 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(3)')[0];
                        // thead1.style.borderRight=boder_right;
                        const thead2 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(6)')[0];
                        thead2.style.borderRight=boder_right;
                        const tdList = ($('#tablereport_date > tbody > tr > td:nth-child(9)'));
                        for($i=0;$i<tdList.length;$i++){
                            tdList[$i].style.borderRight=boder_right;
                        }
                        const tfoot1 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(9)')[0];
                        tfoot1.style.borderRight=boder_right;
                        const tfoot2 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(1)')[0];
                        tfoot2.style.borderRight=boder_right;


                    //배너유형
                        const thead1_2 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(4)')[0];
                        thead1_2.style.borderRight=boder_right;
                        const thead2_2 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(16)')[0];
                        thead2_2.style.borderRight=boder_right;
                        const tdList_2 = ($('#tablereport_date > tbody > tr > td:nth-child(19)'));
                        for($i=0;$i<tdList.length;$i++){
                            tdList_2[$i].style.borderRight=boder_right;
                        }
                        const tfoot1_2 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(19)')[0];
                        tfoot1_2.style.borderRight=boder_right;
                        const tfoot2_2 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(2)')[0];
                        tfoot2_2.style.borderRight=boder_right;


                    // 커머스유형
                        const thead1_3 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(7)')[0];
                        thead1_3.style.borderRight=boder_right;
                        const thead2_3 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(25)')[0];
                        thead2_3.style.borderRight=boder_right;
                        const tdList_3 = ($('#tablereport_date > tbody > tr > td:nth-child(28)'));
                        for($i=0;$i<tdList.length;$i++){
                            tdList_3[$i].style.borderRight=boder_right;
                        }
                        const tfoot1_3 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(28)')[0];
                        tfoot1_3.style.borderRight=boder_right;
                        const tfoot2_3 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(3)')[0];
                        tfoot2_3.style.borderRight=boder_right;


                    //컨텐츠유형
                        const thead1_4 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(6)')[0];
                        thead1_4.style.borderRight=boder_right;
                        const thead2_4 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(30)')[0];
                        thead2_4.style.borderRight=boder_right;
                        const tdList_4 = ($('#tablereport_date > tbody > tr > td:nth-child(33)'));
                        for($i=0;$i<tdList.length;$i++){
                            tdList_4[$i].style.borderRight=boder_right;
                        }
                        const tfoot1_4 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(33)')[0];
                        tfoot1_4.style.borderRight=boder_right;
                        const tfoot2_4 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(4)')[0];
                        tfoot2_4.style.borderRight=boder_right;


            }else if("<?= $_GET['check1']?>" ==2){
                const boder_right = "2px solid #cccccc";
                //매체
                    // 네이버
                        // const thead1 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(3)')[0];
                        // thead1.style.borderRight=boder_right;
                        const thead2 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(10)')[0];
                        thead2.style.borderRight=boder_right;
                        const tdList = ($('#tablereport_date > tbody > tr > td:nth-child(13)'));
                        for($i=0;$i<tdList.length;$i++){
                            tdList[$i].style.borderRight=boder_right;
                        }
                        const tfoot1 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(13)')[0];
                        tfoot1.style.borderRight=boder_right;
                        const tfoot2 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(1)')[0];
                        tfoot2.style.borderRight=boder_right;


                    // 카카오
                        const thead1_2 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(4)')[0];
                        thead1_2.style.borderRight=boder_right;
                        const thead2_2 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(14)')[0];
                        thead2_2.style.borderRight=boder_right;
                        const tdList_2 = ($('#tablereport_date > tbody > tr > td:nth-child(17)'));
                        for($i=0;$i<tdList_2.length;$i++){
                            tdList_2[$i].style.borderRight=boder_right;
                        }
                        const tfoot1_2 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(17)')[0];
                        tfoot1_2.style.borderRight=boder_right;
                        const tfoot2_2 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(2)')[0];
                        tfoot2_2.style.borderRight=boder_right;


                    // 네이트
                        const thead1_3 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(5)')[0];
                        thead1_3.style.borderRight=boder_right;
                        const thead2_3 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(15)')[0];
                        thead2_3.style.borderRight=boder_right;
                        const tdList_2_3 = ($('#tablereport_date > tbody > tr > td:nth-child(18)'));
                        for($i=0;$i<tdList_2_3.length;$i++){
                            tdList_2_3[$i].style.borderRight=boder_right;
                        }
                        const tfoot1_3 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(18)')[0];
                        tfoot1_3.style.borderRight=boder_right;
                        const tfoot2_3 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(3)')[0];
                        tfoot2_3.style.borderRight=boder_right;

                    //크리테오
                        const thead1_4 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(6)')[0];
                        thead1_4.style.borderRight=boder_right;
                        const thead2_4 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(16)')[0];
                        thead2_4.style.borderRight=boder_right;
                        const tdList_2_4 = ($('#tablereport_date > tbody > tr > td:nth-child(19)'));
                        for($i=0;$i<tdList_2_4.length;$i++){
                            tdList_2_4[$i].style.borderRight=boder_right;
                        }
                        const tfoot1_4 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(19)')[0];
                        tfoot1_4.style.borderRight=boder_right;
                        const tfoot2_4 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(4)')[0];
                        tfoot2_4.style.borderRight=boder_right;

                    // 와이더플래닛
                        const thead1_5 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(7)')[0];
                        thead1_5.style.borderRight=boder_right;
                        const thead2_5 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(17)')[0];
                        thead2_5.style.borderRight=boder_right;
                        const tdList_2_5 = ($('#tablereport_date > tbody > tr > td:nth-child(20)'));
                        for($i=0;$i<tdList_2_5.length;$i++){ tdList_2_5[$i].style.borderRight=boder_right;}
                        const tfoot1_5 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(20)')[0];
                        tfoot1_5.style.borderRight=boder_right;
                        const tfoot2_5 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(5)')[0];
                        tfoot2_5.style.borderRight=boder_right;

                    //인라이플
                        const thead1_6 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(8)')[0];
                        thead1_6.style.borderRight=boder_right;
                        const thead2_6 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(18)')[0];
                        thead2_6.style.borderRight=boder_right;
                        const tdList_2_6 = ($('#tablereport_date > tbody > tr > td:nth-child(21)'));
                        for($i=0;$i<tdList_2_6.length;$i++){ tdList_2_6[$i].style.borderRight=boder_right;}
                        const tfoot1_6 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(21)')[0];
                        tfoot1_6.style.borderRight=boder_right;
                        const tfoot2_6 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(6)')[0];
                        tfoot2_6.style.borderRight=boder_right;

                    //리얼클릭
                        const thead1_7 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(9)')[0];
                        thead1_7.style.borderRight=boder_right;
                        const thead2_7 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(19)')[0];
                        thead2_7.style.borderRight=boder_right;
                        const tdList_2_7 = ($('#tablereport_date > tbody > tr > td:nth-child(22)'));
                        for($i=0;$i<tdList_2_7.length;$i++){ tdList_2_7[$i].style.borderRight=boder_right;}
                        const tfoot1_7 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(22)')[0];
                        tfoot1_7.style.borderRight=boder_right;
                        const tfoot2_7 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(7)')[0];
                        tfoot2_7.style.borderRight=boder_right;

                    //레인보우
                        const thead1_8 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(10)')[0];
                        thead1_8.style.borderRight=boder_right;
                        const thead2_8 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(20)')[0];
                        thead2_8.style.borderRight=boder_right;
                        const tdList_2_8 = ($('#tablereport_date > tbody > tr > td:nth-child(23)'));
                        for($i=0;$i<tdList_2_8.length;$i++){ tdList_2_8[$i].style.borderRight=boder_right;}
                        const tfoot1_8 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(23)')[0];
                        tfoot1_8.style.borderRight=boder_right;
                        const tfoot2_8 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(8)')[0];
                        tfoot2_8.style.borderRight=boder_right;

                    //메타
                        const thead1_9 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(11)')[0];
                        thead1_9.style.borderRight=boder_right;
                        const thead2_9 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(21)')[0];
                        thead2_9.style.borderRight=boder_right;
                        const tdList_2_9 = ($('#tablereport_date > tbody > tr > td:nth-child(24)'));
                        for($i=0;$i<tdList_2_9.length;$i++){ tdList_2_9[$i].style.borderRight=boder_right;}
                        const tfoot1_9 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(24)')[0];
                        tfoot1_9.style.borderRight=boder_right;
                        const tfoot2_9 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(9)')[0];
                        tfoot2_9.style.borderRight=boder_right;

                    //지마켓
                        const thead1_10 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(12)')[0];
                        thead1_10.style.borderRight=boder_right;
                        const thead2_10 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(22)')[0];
                        thead2_10.style.borderRight=boder_right;
                        const tdList_2_10 = ($('#tablereport_date > tbody > tr > td:nth-child(25)'));
                        for($i=0;$i<tdList_2_10.length;$i++){ tdList_2_10[$i].style.borderRight=boder_right;}
                        const tfoot1_10 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(25)')[0];
                        tfoot1_10.style.borderRight=boder_right;
                        const tfoot2_10 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(10)')[0];
                        tfoot2_10.style.borderRight=boder_right;


                    //11번가
                        const thead1_11 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(13)')[0];
                        thead1_11.style.borderRight=boder_right;
                        const thead2_11 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(23)')[0];
                        thead2_11.style.borderRight=boder_right;
                        const tdList_2_11 = ($('#tablereport_date > tbody > tr > td:nth-child(26)'));
                        for($i=0;$i<tdList_2_11.length;$i++){ tdList_2_11[$i].style.borderRight=boder_right;}
                        const tfoot1_11 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(26)')[0];
                        tfoot1_11.style.borderRight=boder_right;
                        const tfoot2_11 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(11)')[0];
                        tfoot2_11.style.borderRight=boder_right;


                    //위메프
                        const thead1_12 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(14)')[0];
                        thead1_12.style.borderRight=boder_right;
                        const thead2_12 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(24)')[0];
                        thead2_12.style.borderRight=boder_right;
                        const tdList_2_12 = ($('#tablereport_date > tbody > tr > td:nth-child(27)'));
                        for($i=0;$i<tdList_2_12.length;$i++){ tdList_2_12[$i].style.borderRight=boder_right;}
                        const tfoot1_12 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(27)')[0];
                        tfoot1_12.style.borderRight=boder_right;
                        const tfoot2_12 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(12)')[0];
                        tfoot2_12.style.borderRight=boder_right;


                    //티몬
                        const thead1_13 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(15)')[0];
                        thead1_13.style.borderRight=boder_right;
                        const thead2_13 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(25)')[0];
                        thead2_13.style.borderRight=boder_right;
                        const tdList_2_13 = ($('#tablereport_date > tbody > tr > td:nth-child(28)'));
                        for($i=0;$i<tdList_2_13.length;$i++){ tdList_2_13[$i].style.borderRight=boder_right;}
                        const tfoot1_13 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(28)')[0];
                        tfoot1_13.style.borderRight=boder_right;
                        const tfoot2_13 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(13)')[0];
                        tfoot2_13.style.borderRight=boder_right;

                    //인터파크
                        const thead1_14 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(16)')[0];
                        thead1_14.style.borderRight=boder_right;
                        const thead2_14 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(26)')[0];
                        thead2_14.style.borderRight=boder_right;
                        const tdList_2_14 = ($('#tablereport_date > tbody > tr > td:nth-child(29)'));
                        for($i=0;$i<tdList_2_14.length;$i++){ tdList_2_14[$i].style.borderRight=boder_right;}
                        const tfoot1_14 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(29)')[0];
                        tfoot1_14.style.borderRight=boder_right;
                        const tfoot2_14 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(14)')[0];
                        tfoot2_14.style.borderRight=boder_right;

                    //다나와
                        const thead1_15 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(17)')[0];
                        thead1_15.style.borderRight=boder_right;
                        const thead2_15 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(27)')[0];
                        thead2_15.style.borderRight=boder_right;
                        const tdList_2_15 = ($('#tablereport_date > tbody > tr > td:nth-child(30)'));
                        for($i=0;$i<tdList_2_15.length;$i++){ tdList_2_15[$i].style.borderRight=boder_right;}
                        const tfoot1_15 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(30)')[0];
                        tfoot1_15.style.borderRight=boder_right;
                        const tfoot2_15 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(15)')[0];
                        tfoot2_15.style.borderRight=boder_right;       
                        
                        
                    //쿠팡
                        const thead1_16 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(18)')[0];
                        thead1_16.style.borderRight=boder_right;
                        const thead2_16 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(28)')[0];
                        thead2_16.style.borderRight=boder_right;
                        const tdList_2_16 = ($('#tablereport_date > tbody > tr > td:nth-child(31)'));
                        for($i=0;$i<tdList_2_16.length;$i++){ tdList_2_16[$i].style.borderRight=boder_right;}
                        const tfoot1_16 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(31)')[0];
                        tfoot1_16.style.borderRight=boder_right;
                        const tfoot2_16 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(16)')[0];
                        tfoot2_16.style.borderRight=boder_right;   

                    //코이즈
                        const thead1_17 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(19)')[0];
                        thead1_17.style.borderRight=boder_right;
                        const thead2_17 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(29)')[0];
                        thead2_17.style.borderRight=boder_right;
                        const tdList_2_17 = ($('#tablereport_date > tbody > tr > td:nth-child(32)'));
                        for($i=0;$i<tdList_2_17.length;$i++){ tdList_2_17[$i].style.borderRight=boder_right;}
                        const tfoot1_17 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(32)')[0];
                        tfoot1_17.style.borderRight=boder_right;
                        const tfoot2_17 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(17)')[0];
                        tfoot2_17.style.borderRight=boder_right;  
                        
                    //바이럴
                        const thead1_18 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(20)')[0];
                        thead1_18.style.borderRight=boder_right;
                        const thead2_18 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(30)')[0];
                        thead2_18.style.borderRight=boder_right;
                        const tdList_2_18 = ($('#tablereport_date > tbody > tr > td:nth-child(33)'));
                        for($i=0;$i<tdList_2_18.length;$i++){ tdList_2_18[$i].style.borderRight=boder_right;}
                        const tfoot1_18 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(33)')[0];
                        tfoot1_18.style.borderRight=boder_right;
                        const tfoot2_18 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(18)')[0];
                        tfoot2_18.style.borderRight=boder_right;  
                        
                        
                    //구글
                        const thead1_19 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(21)')[0];
                        thead1_19.style.borderRight=boder_right;
                        const thead2_19 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(31)')[0];
                        thead2_19.style.borderRight=boder_right;
                        const tdList_2_19 = ($('#tablereport_date > tbody > tr > td:nth-child(34)'));
                        for($i=0;$i<tdList_2_19.length;$i++){ tdList_2_19[$i].style.borderRight=boder_right;}
                        const tfoot1_19 = $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(34)')[0];
                        tfoot1_19.style.borderRight=boder_right;
                        const tfoot2_19 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(19)')[0];
                        tfoot2_19.style.borderRight=boder_right;  

                    //위사
                        const thead1_20 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(22)')[0];
                        thead1_20.style.borderRight=boder_right;
                        const thead1_20_1 = $('#tablereport_date > thead > tr:nth-child(1) > th:nth-child(23)')[0];
                        thead1_20_1.style.borderRight=boder_right;
                        const thead2_20 = $('#tablereport_date > thead > tr:nth-child(2) > th:nth-child(32)')[0];
                        thead2_20.style.borderRight=boder_right;
                        const tdList_2_20 = ($('#tablereport_date > tbody > tr > td:nth-child(35)'));
                        for($i=0;$i<tdList_2_20.length;$i++){ tdList_2_20[$i].style.borderRight=boder_right;}
                        const tfoot1_20= $('#tablereport_date > tfoot > tr:nth-child(1) > th:nth-child(35)')[0];
                        tfoot1_20.style.borderRight=boder_right;
                        const tfoot2_20 = $('#tablereport_date > tfoot > tr:nth-child(2) > th:nth-child(20)')[0];
                        tfoot2_20.style.borderRight=boder_right;         


            }      
        }
        
    </script>
<!-- ifram -->
    <iframe name='iFrmSubmit' width="0" height="0" frameborder="0" src="/frame_division/select_division2.php?division1=<?= $division1 ?>&division2=<?= $division2 ?>&em_nm=<?= $em_nm ?>&em_nm_1=<?= $em_nm_1 ?>&type=3&view_type=2"></iframe>